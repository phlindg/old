<!DOCTYPE html>
<!-- saved from url=(0147)https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/client.js.ladda ned" async="" type="text/javascript"></script><script src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/AdCallAggregator" async=""></script>
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader | Curtis Miller's Personal Website</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
	<link rel="pingback" href="https://ntguardian.wordpress.com/xmlrpc.php">
	<link rel="dns-prefetch" href="https://s2.wp.com/">
<link rel="dns-prefetch" href="https://s1.wp.com/">
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.pubmine.com/">
<link rel="dns-prefetch" href="https://x.bidswitch.net/">
<link rel="dns-prefetch" href="https://static.criteo.net/">
<link rel="dns-prefetch" href="https://ib.adnxs.com/">
<link rel="dns-prefetch" href="https://aax.amazon-adsystem.com/">
<link rel="dns-prefetch" href="https://bidder.criteo.com/">
<link rel="dns-prefetch" href="https://cas.criteo.com/">
<link rel="dns-prefetch" href="https://gum.criteo.com/">
<link rel="dns-prefetch" href="https://ads.pubmatic.com/">
<link rel="dns-prefetch" href="https://gads.pubmatic.com/">
<link rel="dns-prefetch" href="https://tpc.googlesyndication.com/">
<link rel="dns-prefetch" href="https://ad.doubleclick.net/">
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://cdn.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.g.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.swid.switchadhub.com/">
<link rel="alternate" type="application/rss+xml" title="Curtis Miller&#39;s Personal Website » Feed" href="https://ntguardian.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Curtis Miller&#39;s Personal Website » Comments Feed" href="https://ntguardian.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Curtis Miller&#39;s Personal Website » Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader Comments Feed" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/feed/">
	<script type="text/javascript" async="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/platform.js.ladda ned"></script><script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1516999477h&ver=4.9.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/wp-emoji-release.min.js.ladda ned" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="all-css-0-1" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource" type="text/css" media="all">
<link rel="stylesheet" id="adaption-arimo-css" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/css" type="text/css" media="all">
<link rel="stylesheet" id="all-css-2-1" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(1)" type="text/css" media="all">
<link rel="stylesheet" id="print-css-3-1" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/global-print.css" type="text/css" media="print">
<link rel="stylesheet" id="all-css-4-1" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(2)" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(3)"></script>
<link rel="stylesheet" id="all-css-0-2" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://ntguardian.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Walk-Forward Analysis Demonstration with backtrader" href="https://ntguardian.wordpress.com/2017/06/19/walk-forward-analysis-demonstration-backtrader/">
<link rel="next" title="Get Started Learning Python for Data Science with “Unpacking NumPy and Pandas”" href="https://ntguardian.wordpress.com/2017/07/03/get-started-learning-python-data-science-unpacking-numpy-and-pandas/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/">
<link rel="shortlink" href="https://wp.me/p27liZ-NH">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader">
<meta property="og:url" content="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/">
<meta property="og:description" content="DISCLAIMER: Any losses incurred based on the content of this post are the responsibility of the trader, not me. I, the author, neither take responsibility for the conduct of others nor offer any gu…">
<meta property="article:published_time" content="2017-06-29T04:12:24+00:00">
<meta property="article:modified_time" content="2017-06-30T15:48:50+00:00">
<meta property="og:site_name" content="Curtis Miller&#39;s Personal Website">
<meta property="og:image" content="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png">
<meta property="og:image:width" content="605">
<meta property="og:image:height" content="400">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@NTGuardian">
<meta name="twitter:text:title" content="Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader">
<meta name="twitter:image:src" content="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=640">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@NTGuardian">
<meta property="fb:app_id" content="249643311490">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">
<link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png">
<link rel="openid.server" href="https://ntguardian.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="https://ntguardian.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://ntguardian.wordpress.com/osd.xml" title="Curtis Miller&#39;s Personal Website">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="Curtis Miller&#39;s Personal Website"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Curtis Miller&#39;s personal website, with resume, portfolio, blog, etc."><meta name="msapplication-task" content="name=Subscribe;action-uri=https://ntguardian.wordpress.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico"><meta name="title" content="Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader | Curtis Miller&#39;s Personal Website on WordPress.com">
<meta name="description" content="DISCLAIMER: Any losses incurred based on the content of this post are the responsibility of the trader, not me. I, the author, neither take responsibility for the conduct of others nor offer any guarantees. None of this should be considered as financial advice; the content of this article is only for educational/entertainment purposes. Introduction Having…">
		<script type="text/javascript">
		var __ATA_PP = { pt: 1, ht: 0, tn: 'adaption', amp: false, siteid: 2694 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/head.js.ladda ned" async=""></script><link rel="amphtml" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/amp/"><link rel="stylesheet" type="text/css" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/shCore.css"><link rel="stylesheet" type="text/css" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/shThemeDefault.css"><style type="text/css" id="syntaxhighlighteranchor"></style>
<style type="text/css" id="custom-colors-css">.main-navigation ul ul{color:#0f0f0f}h1.site-title a:hover{color:#0f0f0f}.main-navigation li a:hover{color:#fff}.main-navigation li a:visited{color:#fff}.main-navigation .current_page_item a{color:#fff}.main-navigation .current-menu-item a{color:#fff}#mobile-link{color:#0f0f0f}.main-navigation ul ul{color:#0f0f0f}.showsub-toggle{color:#0f0f0f}body{background-color:#fafafa}::selection{background-color:#1e8bc3}::-moz-selection{background-color:#1e8bc3}button{border-color:#1e8bc3}input[type="button"]:hover{border-color:#1e8bc3}input[type="reset"]:hover{border-color:#1e8bc3}input[type="submit"]:hover{border-color:#1e8bc3}button:focus{border-color:#1e8bc3}input[type="button"]:focus{border-color:#1e8bc3}input[type="reset"]:focus{border-color:#1e8bc3}input[type="submit"]:focus{border-color:#1e8bc3}button:active{border-color:#1e8bc3}input[type="button"]:active{border-color:#1e8bc3}input[type="reset"]:active{border-color:#1e8bc3}input[type="submit"]:active{border-color:#1e8bc3}.main-navigation ul ul{background:#1e8bc3}.social-links ul a:hover:before{background:#1e8bc3}#mobile-panel{background:#1e8bc3}#header-image.no-header{background:#1e8bc3}.main-navigation{background:#1e8bc3}.main-navigation li a{background:#1e8bc3}button:hover{color:#1e8bc3}input[type="button"]:hover{color:#1e8bc3}input[type="reset"]:hover{color:#1e8bc3}input[type="submit"]:hover{color:#1e8bc3}button:focus{color:#1e8bc3}input[type="button"]:focus{color:#1e8bc3}input[type="reset"]:focus{color:#1e8bc3}input[type="submit"]:focus{color:#1e8bc3}button:active{color:#1e8bc3}input[type="button"]:active{color:#1e8bc3}input[type="reset"]:active{color:#1e8bc3}input[type="submit"]:active{color:#1e8bc3}.main-navigation ul ul li a:hover{background:#18709d}.main-navigation li a:hover{background:#18709d}.entry-summary a:hover{color:#18709d}.entry-content a:hover{color:#18709d}#header-image.no-header{border-color:#18709d}ol.comment-list li.bypostauthor article{border-color:#18709d}h1.entry-title a:hover{color:#18709d}a,a:hover,a:focus,a:active{color:#1e8bc3}.widget a:hover{color:#1e8bc3}#colophon a:hover{color:#1e8bc3}.entry-meta a:hover{color:#1e8bc3}.comment-meta a:hover{color:#1e8bc3}h1{color:#444}h1.entry-title a{color:#444}h1.entry-title a:visited{color:#444}h2{color:#444}h3{color:#444}h4{color:#444}h5{color:#444}h6{color:#444}h7{color:#444}.format-quote .entry-content{color:#444}blockquote{color:#444}input[type="text"]{color:#444}input[type="email"]{color:#444}input[type="url"]{color:#444}input[type="password"]{color:#444}input[type="search"]{color:#444}textarea{color:#444}input[type="text"]:focus{color:#444}input[type="email"]:focus{color:#444}input[type="url"]:focus{color:#444}input[type="password"]:focus{color:#444}input[type="search"]:focus{color:#444}textarea:focus{color:#444}.search-form input.search-field{color:#bababa}.widget{color:#444}.widget h1{color:#444}.widget h1 a{color:#444}.widget h1 a:link{color:#444}#colophon{color:#bababa}#colophon a{color:#444}.entry-meta a{color:#444}.comment-meta a{color:#444}</style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script type="text/javascript" async="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ga.js.ladda ned"></script>
<script src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/publishertag.js.ladda ned"></script><style type="text/css"></style><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/services.css"><iframe src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/showad.html" height="0" width="0" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" style="height: 0px; width: 0px; border: 0px;"></iframe><script src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/outstream.js.ladda ned" async=""></script><style type="text/css">.iowo-adv {overflow: hidden;}.iowo-adv__header {font-family: "Helvetica", Arial, sans-serif !important;font-size: 11.5px !important;text-align: center;position: relative;padding: 5px 0px;letter-spacing: 0.3px !important;font-weight: 300 !important;text-transform: uppercase;color: #aaa}.iowo-adv__sound-icon {width: 32px;cursor: pointer;height: 32px;position: absolute;bottom:12px;right:5px;}.iowo-adv__sound-icon_on {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QYcDigM2jawiwAAAbhJREFUWMPtl7FLHFEQxr+ZtwTytLDwmjSnhf+AYrpUBwGvS7F2YqFNQNjieCnsTlPscdxdZ2MVCORIEewMwf/AlEkRCRaSKqQMCrnbGZtVLPRye2/dJcSpdos33292vjfvLfAQ/3tQHkkajcYqM68YY3bjOD7NsjbwFXfOhSLyDgAPBgMBsJFlPXuK10TkLTNf5ZnKmoM9PvuSqh4w8yOfInjCyhcAHBLRtG8LeQLxJyLyiZkreRg4E0AURTOq+pGZ5/LahsEodwN4A+Dxfc6BUdsw9BF3zkWqOq2q+51O5+ckLWDP4p4R0Wtm/uqcW7wvkXFiVkT6YRiaQgGGw+Gaqn4AAGZeqFarTwsF6PV6F0R0eH3oEFUKBXDO1QBsX70bY74U7YGXAObT5/5dp2QRJuyLyGbmOaCq50Re14XYGPPqb/eDOwGCINhJkkRvHrGqOkNEtXHU2+32Z69JGMfxdwDrt5hrL+1vLpHZA9baLQDvSwNoNptirV0DcFQKQArxx1r7AsBxKQApxO8kSeoi8q0UAADodru/giB4LiI/0pl/UigAALRarTMiWhaRurV25+FX65+LSxNniSadskJNAAAAAElFTkSuQmCC");}.iowo-adv__sound-icon_off {background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAdBJREFUWIXt1b9r1GAcx/HP840u94jo6mD/Aae24I9NHZSCi5NDO5TO7fLkCTgdt15y4C6IdHFwEpxscRHc1dHB0UFBOvToks/Xxch53j3JExNB6XcMz+X1Ti5PApzO/zLD4fBMm99JF7hzbm86nZ6kafp02Rrv/apz7mrnAd77LRF5BCBR1fvLcJKHIvIqy7JrnQV47zdIPgFgAEBEfjvfDH4RwHmSW50EZFl2g+RzEfn535P8FsABYN9au/vHAc65K2VZvhSRwQz+JUmSjRA+GAy2R6MRZ89lWuArAN6KyKU5/PZ4PP4QgwNAcOs4524ZYy7/UmzMQwBLcefcGsmDJjgQuAPe+5sAXocCF+EAGuNA4BlQ1ZW+8WDA38BbBXSJRwfU4SSnMThQswvqcBE5BHChWiMiGoMDDe9AE7zt1Ab0idcG9I0HA0i+6xsHGn4LvPfrAA4a4Md5np+LCah9BuZxVX1G8mMM0jpgwZXvW2s3AdwB8LnXgEV49ZKZTCafVPUuyaNeAkJ4taYoivcico/kSacBTfBq8jx/Y4x5AKD8caicXxMdoKpnSSZ1eDVFUbwwxuwA+Kqqj2MDFm7DNE2vA9i01u7GvttP55+b71U6NuXe6u9vAAAAAElFTkSuQmCC");}.iowo-adv__timer {position: absolute;bottom:5px;left:5px;min-width: 60px;padding: 3px;color: #aaaaaa;border-radius: 5px;font-family: sans-serif;text-align: center;background-color:black;z-index:10;}.iowo-timeline {position: absolute;bottom:0;left:0;width: 100%;height: 5px;background-color: rgba(0, 0, 0, 0.2);}.iowo-timeline__runner {position: relative;height: 5px;background-color: red;-moz-transition: .5s;-ms-transition: .5s;-o-transition: .5s;-webkit-transition: .5s;transition: .5s;transition-property: max-width;}</style><script type="text/javascript" charset="UTF-8" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ima3.js.ladda ned"></script></head>
<body class="post-template-default single single-post postid-3081 single-format-standard mp6 customizer-styles-applied secondary-sidebar highlander-enabled highlander-light">
<div id="page" class="hfeed site">
	
	<div id="mobile-panel">
		<div id="mobile-link"></div><!-- #mobile-link -->
		
		<h1 class="site-title"><a href="https://ntguardian.wordpress.com/" rel="home">Curtis Miller's Personal Website</a></h1>
	</div>

	<div id="panel-block">
		<!-- #mobile-block-->

		
	</div>

	<header id="masthead" class="panel" role="banner">
					<div id="header-image" class="no-header"></div><!-- #header-image .no-header -->
		
		<div class="site-branding">
			<h1 class="site-title"><a href="https://ntguardian.wordpress.com/" rel="home">Curtis Miller's Personal Website</a></h1>
			<h2 class="site-description">Curtis Miller's personal website, with resume, portfolio, blog, etc.</h2>
		</div><!-- .site-branding -->

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<a class="skip-link screen-reader-text" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#content">Skip to content</a>
			<div class="menu"><ul>
<li><a href="https://ntguardian.wordpress.com/">Home</a></li><li class="page_item page-item-333 current_page_parent"><a href="https://ntguardian.wordpress.com/blog/">Blog</a></li>
<li class="page_item page-item-270 page_item_has_children"><a href="https://ntguardian.wordpress.com/professional-information/">Professional Information<div class="showsub-toggle" aria-expanded="false"></div></a>
<ul class="children">
	<li class="page_item page-item-269"><a href="https://ntguardian.wordpress.com/professional-information/my-resume/">My Resume</a></li>
</ul>
</li>
<li class="page_item page-item-3018 page_item_has_children"><a href="https://ntguardian.wordpress.com/video-courses/">Video Courses<div class="showsub-toggle" aria-expanded="false"></div></a>
<ul class="children">
	<li class="page_item page-item-3230"><a href="https://ntguardian.wordpress.com/video-courses/data-acquisition-and-manipulation-with-python/">Data Acquisition and Manipulation with&nbsp;Python</a></li>
	<li class="page_item page-item-3037"><a href="https://ntguardian.wordpress.com/video-courses/unpacking-numpy-and-pandas/">Unpacking NumPy and&nbsp;Pandas</a></li>
</ul>
</li>
<li class="page_item page-item-951 page_item_has_children"><a href="https://ntguardian.wordpress.com/education/">Educational History<div class="showsub-toggle" aria-expanded="false"></div></a>
<ul class="children">
	<li class="page_item page-item-266 page_item_has_children"><a href="https://ntguardian.wordpress.com/education/graduate-education/">Graduate Education<div class="showsub-toggle" aria-expanded="false"></div></a>
	<ul class="children">
		<li class="page_item page-item-634"><a href="https://ntguardian.wordpress.com/education/graduate-education/data-mining/">Data Mining</a></li>
		<li class="page_item page-item-632"><a href="https://ntguardian.wordpress.com/education/graduate-education/database-systems/">Database Systems</a></li>
		<li class="page_item page-item-507"><a href="https://ntguardian.wordpress.com/education/graduate-education/linear-models/">Linear Models</a></li>
		<li class="page_item page-item-508"><a href="https://ntguardian.wordpress.com/education/graduate-education/machine-learning/">Machine Learning</a></li>
		<li class="page_item page-item-629"><a href="https://ntguardian.wordpress.com/education/graduate-education/multilinear-models/">Multilinear Models</a></li>
		<li class="page_item page-item-638"><a href="https://ntguardian.wordpress.com/education/graduate-education/probabilistic-models/">Probabilistic Models</a></li>
		<li class="page_item page-item-509"><a href="https://ntguardian.wordpress.com/education/graduate-education/reading-course-on-time-series-models/">Reading Course on Time Series&nbsp;Models</a></li>
		<li class="page_item page-item-510"><a href="https://ntguardian.wordpress.com/education/graduate-education/visualization/">Visualization</a></li>
	</ul>
</li>
	<li class="page_item page-item-328 page_item_has_children"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/">Undergraduate Education<div class="showsub-toggle" aria-expanded="false"></div></a>
	<ul class="children">
		<li class="page_item page-item-388"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/applied-statistics-i/">Applied Statistics I</a></li>
		<li class="page_item page-item-389"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/applied-statistics-ii/">Applied Statistics II</a></li>
		<li class="page_item page-item-390"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/construction-of-knowledge/">Construction of Knowledge</a></li>
		<li class="page_item page-item-391"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/game-theory/">Game Theory</a></li>
		<li class="page_item page-item-392"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/hinckley-institute-of-politics-washington-d-c-internship/">Hinckley Institute of Politics Washington, D.C.&nbsp;Internship</a></li>
		<li class="page_item page-item-393"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/honors-core-in-intellectual-traditions-2/">Honor’s Core in Intellectual Traditions&nbsp;2</a></li>
		<li class="page_item page-item-394"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/honors-thesis/">Honor’s Thesis</a></li>
		<li class="page_item page-item-395"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/industrial-organizational-economics/">Industrial-Organizational Economics</a></li>
		<li class="page_item page-item-396"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/international-economics/">International Economics</a></li>
		<li class="page_item page-item-397"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/marxist-economics/">Marxist Economics</a></li>
		<li class="page_item page-item-398"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/monetary-theory-and-policy/">Monetary Theory and&nbsp;Policy</a></li>
		<li class="page_item page-item-399"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/principles-of-econometrics/">Principles of Econometrics</a></li>
		<li class="page_item page-item-400"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/principles-of-macroeconomics/">Principles of Macroeconomics</a></li>
		<li class="page_item page-item-401"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/stochastic-processes-and-simulation-i/">Stochastic Processes and Simulation&nbsp;I</a></li>
		<li class="page_item page-item-402"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/stochastic-processes-and-simulation-ii/">Stochastic Processes and Simulation&nbsp;II</a></li>
		<li class="page_item page-item-403"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/the-valley-as-a-laboratory/">The Valley as a&nbsp;Laboratory</a></li>
		<li class="page_item page-item-265 page_item_has_children"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/">General Education<div class="showsub-toggle" aria-expanded="false"></div></a>
		<ul class="children">
			<li class="page_item page-item-340"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/biological-science/">Biological Science</a></li>
			<li class="page_item page-item-341"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/composition/">Composition</a></li>
			<li class="page_item page-item-342"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/depth-course/">Depth Course</a></li>
			<li class="page_item page-item-343"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/humanitiesdiversity/">Humanities/Diversity</a></li>
			<li class="page_item page-item-344"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/interdisciplinary/">Interdisciplinary</a></li>
			<li class="page_item page-item-345"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/lifelong-wellness/">Lifelong Wellness</a></li>
			<li class="page_item page-item-346"><a href="https://ntguardian.wordpress.com/education/undergraduate-education/general-education/physical-science/">Physical Science</a></li>
		</ul>
</li>
	</ul>
</li>
</ul>
</li>
<li class="page_item page-item-1007 page_item_has_children"><a href="https://ntguardian.wordpress.com/about-me/">About Me<div class="showsub-toggle" aria-expanded="false"></div></a>
<ul class="children">
	<li class="page_item page-item-264"><a href="https://ntguardian.wordpress.com/about-me/extracurricular-pursuits/">Hobbies</a></li>
</ul>
</li>
</ul></div>
		</nav><!-- #site-navigation .main-navigation -->

		
					<div class="widget-areas">
				<div class="widget-area">
					<aside id="search-4" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://ntguardian.wordpress.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search …" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form></aside><aside id="wp_tag_cloud-7" class="widget wp_widget_tag_cloud"><h1 class="widget-title">Tags</h1><div style="overflow:hidden"><a href="https://ntguardian.wordpress.com/tag/2008/" class="tag-cloud-link tag-link-18856 tag-link-position-1" style="font-size: 8pt;" aria-label="2008 (5 items)">2008</a>
<a href="https://ntguardian.wordpress.com/tag/2014/" class="tag-cloud-link tag-link-1173184 tag-link-position-2" style="font-size: 11pt;" aria-label="2014 (7 items)">2014</a>
<a href="https://ntguardian.wordpress.com/tag/2016/" class="tag-cloud-link tag-link-708859 tag-link-position-3" style="font-size: 9.75pt;" aria-label="2016 (6 items)">2016</a>
<a href="https://ntguardian.wordpress.com/tag/activism/" class="tag-cloud-link tag-link-6722 tag-link-position-4" style="font-size: 12.25pt;" aria-label="activism (8 items)">activism</a>
<a href="https://ntguardian.wordpress.com/tag/backtesting/" class="tag-cloud-link tag-link-1118082 tag-link-position-5" style="font-size: 11pt;" aria-label="backtesting (7 items)">backtesting</a>
<a href="https://ntguardian.wordpress.com/tag/cormania/" class="tag-cloud-link tag-link-530549029 tag-link-position-6" style="font-size: 12.25pt;" aria-label="cormania (8 items)">cormania</a>
<a href="https://ntguardian.wordpress.com/tag/data-science/" class="tag-cloud-link tag-link-21818323 tag-link-position-7" style="font-size: 8pt;" aria-label="data science (5 items)">data science</a>
<a href="https://ntguardian.wordpress.com/tag/debugging/" class="tag-cloud-link tag-link-70886 tag-link-position-8" style="font-size: 9.75pt;" aria-label="debugging (6 items)">debugging</a>
<a href="https://ntguardian.wordpress.com/tag/democrats/" class="tag-cloud-link tag-link-4257 tag-link-position-9" style="font-size: 11pt;" aria-label="democrats (7 items)">democrats</a>
<a href="https://ntguardian.wordpress.com/tag/election/" class="tag-cloud-link tag-link-19229 tag-link-position-10" style="font-size: 9.75pt;" aria-label="election (6 items)">election</a>
<a href="https://ntguardian.wordpress.com/tag/finance/" class="tag-cloud-link tag-link-4269 tag-link-position-11" style="font-size: 12.25pt;" aria-label="finance (8 items)">finance</a>
<a href="https://ntguardian.wordpress.com/tag/game-art/" class="tag-cloud-link tag-link-246949 tag-link-position-12" style="font-size: 8pt;" aria-label="game art (5 items)">game art</a>
<a href="https://ntguardian.wordpress.com/tag/game-design/" class="tag-cloud-link tag-link-14913 tag-link-position-13" style="font-size: 11pt;" aria-label="game design (7 items)">game design</a>
<a href="https://ntguardian.wordpress.com/tag/gamemaker-studio/" class="tag-cloud-link tag-link-92800661 tag-link-position-14" style="font-size: 11pt;" aria-label="gamemaker: studio (7 items)">gamemaker: studio</a>
<a href="https://ntguardian.wordpress.com/tag/gml/" class="tag-cloud-link tag-link-1061560 tag-link-position-15" style="font-size: 9.75pt;" aria-label="gml (6 items)">gml</a>
<a href="https://ntguardian.wordpress.com/tag/google/" class="tag-cloud-link tag-link-81 tag-link-position-16" style="font-size: 12.25pt;" aria-label="google (8 items)">google</a>
<a href="https://ntguardian.wordpress.com/tag/google-finance/" class="tag-cloud-link tag-link-544551 tag-link-position-17" style="font-size: 9.75pt;" aria-label="google finance (6 items)">google finance</a>
<a href="https://ntguardian.wordpress.com/tag/gui/" class="tag-cloud-link tag-link-7168 tag-link-position-18" style="font-size: 8pt;" aria-label="gui (5 items)">gui</a>
<a href="https://ntguardian.wordpress.com/tag/honor-3700/" class="tag-cloud-link tag-link-530549082 tag-link-position-19" style="font-size: 17.25pt;" aria-label="honor 3700 (13 items)">honor 3700</a>
<a href="https://ntguardian.wordpress.com/tag/moving-average/" class="tag-cloud-link tag-link-797502 tag-link-position-20" style="font-size: 11pt;" aria-label="moving average (7 items)">moving average</a>
<a href="https://ntguardian.wordpress.com/tag/moving-average-crossover-strategy/" class="tag-cloud-link tag-link-230273744 tag-link-position-21" style="font-size: 11pt;" aria-label="moving average crossover strategy (7 items)">moving average crossover strategy</a>
<a href="https://ntguardian.wordpress.com/tag/pandas/" class="tag-cloud-link tag-link-32629 tag-link-position-22" style="font-size: 12.25pt;" aria-label="pandas (8 items)">pandas</a>
<a href="https://ntguardian.wordpress.com/tag/programming/" class="tag-cloud-link tag-link-196 tag-link-position-23" style="font-size: 22pt;" aria-label="programming (21 items)">programming</a>
<a href="https://ntguardian.wordpress.com/tag/salt-lake-city/" class="tag-cloud-link tag-link-70047 tag-link-position-24" style="font-size: 11pt;" aria-label="salt lake city (7 items)">salt lake city</a>
<a href="https://ntguardian.wordpress.com/tag/statistics/" class="tag-cloud-link tag-link-5849 tag-link-position-25" style="font-size: 9.75pt;" aria-label="statistics (6 items)">statistics</a>
<a href="https://ntguardian.wordpress.com/tag/stock-market/" class="tag-cloud-link tag-link-13843 tag-link-position-26" style="font-size: 13.5pt;" aria-label="stock market (9 items)">stock market</a>
<a href="https://ntguardian.wordpress.com/tag/stocks/" class="tag-cloud-link tag-link-8589 tag-link-position-27" style="font-size: 14.5pt;" aria-label="stocks (10 items)">stocks</a>
<a href="https://ntguardian.wordpress.com/tag/suburbs/" class="tag-cloud-link tag-link-102845 tag-link-position-28" style="font-size: 8pt;" aria-label="suburbs (5 items)">suburbs</a>
<a href="https://ntguardian.wordpress.com/tag/technology/" class="tag-cloud-link tag-link-6 tag-link-position-29" style="font-size: 8pt;" aria-label="technology (5 items)">technology</a>
<a href="https://ntguardian.wordpress.com/tag/visualization/" class="tag-cloud-link tag-link-44111 tag-link-position-30" style="font-size: 8pt;" aria-label="visualization (5 items)">visualization</a></div></aside>				</div><!-- .widget-area -->
			</div><!-- .widgets-areas -->
		
	</header><!-- #masthead .site-header -->

		<div id="secondary">
		<div class="widget-areas">
			<div class="widget-area">
				<aside id="top-posts-7" class="widget widget_top-posts"><h1 class="widget-title">Top Posts &amp; Pages</h1><ul>				<li>
										<a href="https://ntguardian.wordpress.com/2016/09/19/introduction-stock-market-data-python-1/" class="bump-view" data-bump-view="tp">
						An Introduction to Stock Market Data Analysis with Python (Part 1)					</a>
									</li>
							<li>
										<a href="https://ntguardian.wordpress.com/2017/03/27/introduction-stock-market-data-r-1/" class="bump-view" data-bump-view="tp">
						An Introduction to Stock Market Data Analysis with R (Part 1)					</a>
									</li>
							<li>
										<a href="https://ntguardian.wordpress.com/2016/09/26/introduction-stock-market-data-python-2/" class="bump-view" data-bump-view="tp">
						An Introduction to Stock Market Data Analysis with Python (Part 2)					</a>
									</li>
			</ul></aside><aside id="categories-8" class="widget widget_categories"><h1 class="widget-title">Categories</h1>		<ul>
	<li class="cat-item cat-item-317434"><a href="https://ntguardian.wordpress.com/category/aar/">AAR</a> (1)
</li>
	<li class="cat-item cat-item-582476519"><a href="https://ntguardian.wordpress.com/category/books-and-video-courses/">Books and Video Courses</a> (2)
</li>
	<li class="cat-item cat-item-118121"><a href="https://ntguardian.wordpress.com/category/economics-and-finance/">Economics and Finance</a> (18)
</li>
	<li class="cat-item cat-item-43585633"><a href="https://ntguardian.wordpress.com/category/gameprog/" title="Blog posts related to game programming.">Game Programming</a> (9)
</li>
	<li class="cat-item cat-item-530548945"><a href="https://ntguardian.wordpress.com/category/honor3700/" title="Blog posts for HONOR 3700.">HONOR 3700</a> (14)
</li>
	<li class="cat-item cat-item-398"><a href="https://ntguardian.wordpress.com/category/politics/" title="Blog posts related to political topics.">Politics</a> (13)
</li>
	<li class="cat-item cat-item-832"><a href="https://ntguardian.wordpress.com/category/python/">Python</a> (15)
</li>
	<li class="cat-item cat-item-10189"><a href="https://ntguardian.wordpress.com/category/r/" title="Blog posts for R programming.">R</a> (19)
</li>
	<li class="cat-item cat-item-668"><a href="https://ntguardian.wordpress.com/category/research/">Research</a> (1)
</li>
	<li class="cat-item cat-item-22379"><a href="https://ntguardian.wordpress.com/category/data/" title="Blog posts related to statistics and data science.">Statistics and Data Science</a> (26)
</li>
	<li class="cat-item cat-item-1"><a href="https://ntguardian.wordpress.com/category/uncategorized/">Uncategorized</a> (5)
</li>
		</ul>
</aside><aside id="media_image-3" class="widget widget_media_image"><h1 class="widget-title">Latest Video Course</h1><style>.widget.widget_media_image { overflow: hidden; }.widget.widget_media_image img { height: auto; max-width: 100%; }</style><a href="https://ntguardian.wordpress.com/video-courses/" class="" rel="" target=""><img width="302" height="373" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/dataacquisitionandmanipulationwithpythoncover.png" class="image wp-image-3252 aligncenter attachment-full size-full" alt="" style="max-width: 100%; height: auto;" title="Book Cover" srcset="https://ntguardian.files.wordpress.com/2017/10/dataacquisitionandmanipulationwithpythoncover.png 302w, https://ntguardian.files.wordpress.com/2017/10/dataacquisitionandmanipulationwithpythoncover.png?w=121&amp;h=150 121w, https://ntguardian.files.wordpress.com/2017/10/dataacquisitionandmanipulationwithpythoncover.png?w=243&amp;h=300 243w" sizes="(max-width: 302px) 100vw, 302px" data-attachment-id="3252" data-permalink="https://ntguardian.wordpress.com/dataacquisitionandmanipulationwithpythoncover/" data-orig-file="https://ntguardian.files.wordpress.com/2017/10/dataacquisitionandmanipulationwithpythoncover.png" data-orig-size="302,373" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="DataAcquisitionandManipulationwithPythonCover" data-image-description="" data-medium-file="https://ntguardian.files.wordpress.com/2017/10/dataacquisitionandmanipulationwithpythoncover.png?w=243" data-large-file="https://ntguardian.files.wordpress.com/2017/10/dataacquisitionandmanipulationwithpythoncover.png?w=302"></a></aside><aside id="wpcom_social_media_icons_widget-9" class="widget widget_wpcom_social_media_icons_widget"><h1 class="widget-title">Social</h1><ul><li><a href="https://twitter.com/NTGuardian/" class="genericon genericon-twitter" target="_blank"><span class="screen-reader-text">View NTGuardian’s profile on Twitter</span></a></li><li><a href="https://www.linkedin.com/in/curtis-miller-41568095/" class="genericon genericon-linkedin" target="_blank"><span class="screen-reader-text">View curtis-miller-41568095’s profile on LinkedIn</span></a></li><li><a href="https://github.com/ntguardian/" class="genericon genericon-github" target="_blank"><span class="screen-reader-text">View ntguardian’s profile on GitHub</span></a></li><li><a href="https://www.youtube.com/channel/UCUmC4ZXoRPmtOsZn2wOu9zg/" class="genericon genericon-youtube" target="_blank"><span class="screen-reader-text">View UCUmC4ZXoRPmtOsZn2wOu9zg’s profile on YouTube</span></a></li><li><a href="https://plus.google.com/u/0/101301351154608272073/" class="genericon genericon-googleplus" target="_blank"><span class="screen-reader-text">View 101301351154608272073’s profile on Google+</span></a></li></ul></aside><aside id="follow_button_widget-5" class="widget widget_follow_button_widget">
		<iframe src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/index.html" width="100%" height="20" frameborder="0" scrolling="no"></iframe>
		<script type="text/javascript">(function(d){var f = d.getElementsByTagName('SCRIPT')[0], p = d.createElement('SCRIPT');p.type = 'text/javascript';p.async = true;p.src = '//widgets.wp.com/platform.js';f.parentNode.insertBefore(p,f);}(document));</script>

		</aside><aside id="rss_links-9" class="widget widget_rss_links"><h1 class="widget-title">Subscribe Via RSS</h1><ul><li><a href="https://ntguardian.wordpress.com/feed/" title="Subscribe to Posts">RSS - Posts</a></li><li><a href="https://ntguardian.wordpress.com/comments/feed/" title="Subscribe to Comments">RSS - Comments</a></li></ul>
</aside><aside id="archives-6" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<label class="screen-reader-text" for="archives-dropdown-6">Archives</label>
		<select id="archives-dropdown-6" name="archive-dropdown" onchange="document.location.href=this.options[this.selectedIndex].value;">
			
			<option value="">Select Month</option>
				<option value="https://ntguardian.wordpress.com/2018/01/"> January 2018 &nbsp;(1)</option>
	<option value="https://ntguardian.wordpress.com/2017/11/"> November 2017 &nbsp;(2)</option>
	<option value="https://ntguardian.wordpress.com/2017/10/"> October 2017 &nbsp;(2)</option>
	<option value="https://ntguardian.wordpress.com/2017/08/"> August 2017 &nbsp;(1)</option>
	<option value="https://ntguardian.wordpress.com/2017/07/"> July 2017 &nbsp;(6)</option>
	<option value="https://ntguardian.wordpress.com/2017/06/"> June 2017 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2017/05/"> May 2017 &nbsp;(3)</option>
	<option value="https://ntguardian.wordpress.com/2017/04/"> April 2017 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2017/03/"> March 2017 &nbsp;(3)</option>
	<option value="https://ntguardian.wordpress.com/2017/02/"> February 2017 &nbsp;(1)</option>
	<option value="https://ntguardian.wordpress.com/2016/12/"> December 2016 &nbsp;(2)</option>
	<option value="https://ntguardian.wordpress.com/2016/11/"> November 2016 &nbsp;(3)</option>
	<option value="https://ntguardian.wordpress.com/2016/10/"> October 2016 &nbsp;(3)</option>
	<option value="https://ntguardian.wordpress.com/2016/09/"> September 2016 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2016/08/"> August 2016 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2016/06/"> June 2016 &nbsp;(1)</option>
	<option value="https://ntguardian.wordpress.com/2015/08/"> August 2015 &nbsp;(1)</option>
	<option value="https://ntguardian.wordpress.com/2015/07/"> July 2015 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2015/06/"> June 2015 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2014/12/"> December 2014 &nbsp;(2)</option>
	<option value="https://ntguardian.wordpress.com/2014/11/"> November 2014 &nbsp;(4)</option>
	<option value="https://ntguardian.wordpress.com/2014/10/"> October 2014 &nbsp;(2)</option>
	<option value="https://ntguardian.wordpress.com/2014/09/"> September 2014 &nbsp;(6)</option>
	<option value="https://ntguardian.wordpress.com/2012/01/"> January 2012 &nbsp;(2)</option>

		</select>
		</aside><aside id="linkcat-1356" class="widget widget_links"><h1 class="widget-title">Blogroll</h1>
	<ul class="xoxo blogroll">
<li><a href="https://mathbabe.org/">Cathy O'Neil's blog</a></li>
<li><a href="http://fivethirtyeight.com/" title="Nate Silver’s excellent website." target="_blank">FiveThirtyEight</a></li>
<li><a href="https://www.packtpub.com/books/content/blogs">Packt Publishing</a></li>
<li><a href="http://planet.scipy.org/" title="SciPy blog aggregator">Planet SciPy</a></li>
<li><a href="https://quantstrattrader.wordpress.com/">QuantStrat TradeR</a></li>
<li><a href="https://www.r-bloggers.com/" title="R-Bloggers is a network of bloggers discussing R programming and data analysis with R." target="_blank">R-Bloggers</a></li>
<li><a href="http://www.yoyogames.com/blog/" title="The official blog for GameMaker: Studio" target="_blank">YoYo Games Blog</a></li>

	</ul>
</aside>
<aside id="linkcat-534186378" class="widget widget_links"><h1 class="widget-title">Links</h1>
	<ul class="xoxo blogroll">
<li><a href="https://www.r-users.com/" title="Website where jobs for R programmers are posted">R-users</a></li>
<li><a href="http://math.utah.edu/" title="Website for the math department of the University of Utah." target="_blank">University of Utah Mathematics Department</a></li>

	</ul>
</aside>
<aside id="rss-18" class="widget widget_rss"><h1 class="widget-title"><a class="rsswidget" href="https://www.r-users.com/feed/?post_type=job_listing" title="Syndicate this content"><img style="background: orange; color: white; border: none;" width="14" height="14" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/rss.png" alt="RSS" scale="0"></a> <a class="rsswidget" href="https://www.r-users.com/" title="A job board for people and companies looking to hire R users">Jobs for R Users</a></h1><ul><li><a class="rsswidget" href="https://www.r-users.com/jobs/r-sql-google-cloud-platform-microsoft-powerbi-multiplatform-apis-automated-reporting-project-london-u-k/" title="Data Science Consultant (short term freelance role) As an Analytics/Big Data Consultant, you will be helping an audience and data insights analytics team to create bespoke automated reporting and insights solution. You will help with the state of art professional dashboards development, you will help us with code review, validation, and optimisation. You wil […]">R + SQL + Google Cloud Platform + Microsoft PowerBi + Multiplatform APIs Automated Reporting Project @ London, U.K.</a> <span class="rss-date">February 21, 2018</span></li><li><a class="rsswidget" href="https://www.r-users.com/jobs/data-scientist-and-r-programmer-cambridge-massachusetts-u-s/" title="Tariffville, CT or Boston area Join us in our mission to defeat diseases by applying your skills to real-world biomedical problems. Metrum Research Group is seeking a full-time R programming specialist to support our data analysis, modeling, and simulation services. This is an excellent opportunity to develop as an R programmer, gaining experience with cutti […]">Data Scientist and R Programmer @ Cambridge, Massachusetts, U.S.</a> <span class="rss-date">February 18, 2018</span></li><li><a class="rsswidget" href="https://www.r-users.com/jobs/data-scientist-and-r-programmer-simsbury-connecticut-u-s/" title="Tariffville, CT or Boston area Join us in our mission to defeat diseases by applying your skills to real-world biomedical problems. Metrum Research Group is seeking a full-time R programming specialist to support our data analysis, modeling, and simulation services. This is an excellent opportunity to develop as an R programmer, gaining experience with cutti […]">Data Scientist and R Programmer @ Simsbury, Connecticut, U.S.</a> <span class="rss-date">February 18, 2018</span></li></ul></aside><aside id="rss-22" class="widget widget_rss"><h1 class="widget-title"><a class="rsswidget" href="https://www.python.org/jobs/feed/rss/" title="Syndicate this content"><img style="background: orange; color: white; border: none;" width="14" height="14" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/rss.png" alt="RSS" scale="0"></a> <a class="rsswidget" href="https://python.org/jobs/" title="Python jobs from Python.org">Jobs for Python Users</a></h1><ul><li><a class="rsswidget" href="https://python.org/jobs/3115/" title="lONDON,lONDON,United Kingdom Great opportunity to be a key part of a small team that will build high volume FinTech platforms. We have recently hired 7 brilliant individuals and we would like more of you to come and join the team, so if in doubt please send us your CV and tell us about you. YOU: - Python developer with several years of experience. - You code […]">Python Developer - Octopus Labs</a></li><li><a class="rsswidget" href="https://python.org/jobs/3112/" title="Montreal,Québec,Canada Now we urgently need an experienced developer for backend, DB, some frontend, and AWS hosting. Once we finish the main work on backend, we can consider you for BigData and ML in human genetics. Full-time, remote is fine. The product we&#39;ve been building is amazing, you will be proud to be part of it. MUST know python and Django fra […]">Python Developer  - BioMD Genetics Inc</a></li><li><a class="rsswidget" href="https://python.org/jobs/3111/" title="Ottawa,Ontario,Canada At Shopify, we empower 500,000+ entrepreneurs all over the world. We&#39;re looking for hard-working, passionate people to help us make commerce better. For over 10 years we have been incredibly data greedy and are super driven when it comes to using these insights to help drive our product direction and make things better for our merc […]">Machine Learning Lead - Shipping Services - Shopify</a></li></ul></aside>			</div><!-- .widget-area -->
		</div><!-- .widgets-areas -->
	</div>

	<div id="content" class="site-content">
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-3081" class="post-3081 post type-post status-publish format-standard has-post-thumbnail hentry category-economics-and-finance category-python category-r category-data tag-alpha tag-backtesting tag-backtrader tag-beta tag-blogging tag-cross-validation tag-finance tag-google tag-google-finance tag-graduate-school tag-machine-learning tag-moving-average tag-moving-average-crossover-strategy tag-numpy tag-optimization tag-packt-publishing tag-pandas tag-performanceanalytics tag-portfolio-analytics tag-programming tag-pyfolio tag-quantmod tag-quantopian tag-r-python-integration tag-rpy2 tag-sharpe-ratio tag-sortino-ratio tag-technical-analysis tag-unpacking-numpy-and-pandas tag-walk-forward-analysis tag-walk-forward-efficiency-ratio tag-yahoo-finance">

			<div class="entry-thumbnail">
			<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/" title="Permalink to Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader" rel="3081">
				<img width="605" height="400" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/spymaxdrawdownillustration.png" class="attachment-featured-image size-featured-image wp-post-image" alt="" srcset="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png 605w, https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=150 150w, https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=300 300w" sizes="(max-width: 605px) 100vw, 605px" data-attachment-id="3088" data-permalink="https://ntguardian.wordpress.com/spymaxdrawdownillustration/" data-orig-file="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png" data-orig-size="605,400" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="SPYMaxDrawdownIllustration" data-image-description="" data-medium-file="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=300" data-large-file="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=605">			</a>
		</div><!-- ..entry-thumbnail -->
	
	<div class="entry-meta entry-top">
		<span class="posted-on">Posted on <a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/" rel="bookmark"><time class="entry-date published" datetime="2017-06-28T22:12:24+00:00">June 28, 2017</time><time class="updated" datetime="2017-06-30T09:48:50+00:00">June 30, 2017</time></a></span>
						<span class="cat-links"><a href="https://ntguardian.wordpress.com/category/economics-and-finance/" rel="category tag">Economics and Finance</a>, <a href="https://ntguardian.wordpress.com/category/python/" rel="category tag">Python</a>, <a href="https://ntguardian.wordpress.com/category/r/" rel="category tag">R</a>, <a href="https://ntguardian.wordpress.com/category/data/" rel="category tag">Statistics and Data Science</a></span>
			
		
		
	</div><!-- .entry-meta -->

	<header class="entry-header">
		<h1 class="entry-title">
			Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and&nbsp;backtrader		</h1>
	</header><!-- .entry-header -->

	<div class="entry-content">
		<p><strong>DISCLAIMER: Any losses incurred based on the content of this post are the responsibility of the trader, not me. I, the author, neither take responsibility for the conduct of others nor offer any guarantees. None of this should be considered as financial advice; the content of this article is only for educational/entertainment purposes.</strong></p>
<h2>Introduction</h2>
<p>Having figured out <a href="https://ntguardian.wordpress.com/category/economics-and-finance/">how to perform walk-forward analysis in Python with <strong>backtrader</strong></a>, I want to have a look at evaluating a strategy’s performance. So far, I have cared about only one metric: the final value of the account at the end of a backtest relative. This should not be the only metric considered. Most people care not only about how much money was made but how much risk was taken on. People are risk-averse; one of finance’s leading principles is that higher risk should be compensated by higher returns. Thus many metrics exist that adjust returns for how much risk was taken on. Perhaps when optimizing only with respect to the final return of the strategy we end up choosing highly volatile strategies that lead to huge losses in out-of-sample data. Adjusting for risk may lead to better strategies being chosen.</p>
<p><span id="more-3081"></span></p>
<p>In this article I will be looking more at <strong>backtrader</strong>‘s <code>Analyzer</code>s. These compute metrics for strategies after a backtest that users can then review. We can easily add an <code>Analyzer</code> to a <code>Cerebro</code> instance, <a href="https://www.backtrader.com/docu/analyzers-reference.html"><strong>backtrader</strong> already comes with many useful <code>Analyzers</code></a> computing common statistics, and creating a new <code>Analyzer</code> for a new statistic is easy to do. Additionally, <a href="https://www.backtrader.com/docu/analyzers/pyfolio-integration/pyfolio-integration.html"><strong>backtrader</strong> allows for <strong>PyFolio</strong> integration</a>, if <strong>PyFolio</strong> is more to your style.</p>
<p>I review these methods here.</p>
<h2>backtrader Analyzers</h2>
<p>Let’s start by picking up where we left off. Most of this code resembles my code from <a href="https://ntguardian.wordpress.com/2017/06/12/getting-started-with-backtrader/">previous</a> <a href="https://ntguardian.wordpress.com/2017/06/19/walk-forward-analysis-demonstration-backtrader/">articles</a>, though I made some (mostly cosmetic) improvements, such as to the strategy <code>SMAC</code>. I also import everything I will be needing in this article at the very beginning.</p>
<div><div id="highlighter_41725" class="syntaxhighlighter   python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">sklearn.model_selection </code><code class="python keyword">import</code> <code class="python plain">TimeSeriesSplit</code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code> <code class="python plain">sklearn.utils </code><code class="python keyword">import</code> <code class="python plain">indexable</code></div><div class="line number3 index2 alt2"><code class="python keyword">from</code> <code class="python plain">sklearn.utils.validation </code><code class="python keyword">import</code> <code class="python plain">_num_samples</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code> <code class="python plain">numpy as np</code></div><div class="line number5 index4 alt2"><code class="python keyword">import</code> <code class="python plain">backtrader as bt</code></div><div class="line number6 index5 alt1"><code class="python keyword">import</code> <code class="python plain">backtrader.indicators as btind</code></div><div class="line number7 index6 alt2"><code class="python keyword">import</code> <code class="python plain">backtrader.analyzers as btanal</code></div><div class="line number8 index7 alt1"><code class="python keyword">import</code> <code class="python plain">datetime as dt</code></div><div class="line number9 index8 alt2"><code class="python keyword">import</code> <code class="python plain">pandas as pd</code></div><div class="line number10 index9 alt1"><code class="python keyword">import</code> <code class="python plain">pandas_datareader as web</code></div><div class="line number11 index10 alt2"><code class="python keyword">from</code> <code class="python plain">pandas </code><code class="python keyword">import</code> <code class="python plain">Series, DataFrame</code></div><div class="line number12 index11 alt1"><code class="python keyword">import</code> <code class="python plain">random</code></div><div class="line number13 index12 alt2"><code class="python keyword">import</code> <code class="python plain">pyfolio as pf</code></div><div class="line number14 index13 alt1"><code class="python keyword">from</code> <code class="python plain">copy </code><code class="python keyword">import</code> <code class="python plain">deepcopy</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="python keyword">from</code> <code class="python plain">rpy2.robjects.packages </code><code class="python keyword">import</code> <code class="python plain">importr</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python plain">pa </code><code class="python keyword">=</code> <code class="python plain">importr(</code><code class="python string">"PerformanceAnalytics"</code><code class="python plain">)&nbsp;&nbsp;&nbsp; </code><code class="python comments"># The R package PerformanceAnalytics, containing the R function VaR</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="python keyword">from</code> <code class="python plain">rpy2.robjects </code><code class="python keyword">import</code> <code class="python plain">numpy2ri, pandas2ri</code></div><div class="line number21 index20 alt2"><code class="python plain">numpy2ri.activate()</code></div><div class="line number22 index21 alt1"><code class="python plain">pandas2ri.activate()</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_559718" class="syntaxhighlighter   python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">class</code> <code class="python plain">SMAC(bt.Strategy):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""A simple moving average crossover strategy; crossing of a fast and slow moving average generates buy/sell</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">signals"""</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">params </code><code class="python keyword">=</code> <code class="python plain">{</code><code class="python string">"fast"</code><code class="python plain">: </code><code class="python value">20</code><code class="python plain">, </code><code class="python string">"slow"</code><code class="python plain">: </code><code class="python value">50</code><code class="python plain">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># The windows for both fast and slow moving averages</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"optim"</code><code class="python plain">: </code><code class="python color1">False</code><code class="python plain">, </code><code class="python string">"optim_fs"</code><code class="python plain">: (</code><code class="python value">20</code><code class="python plain">, </code><code class="python value">50</code><code class="python plain">)}&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Used for optimization; equivalent of fast and slow, but a tuple</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># The first number in the tuple is the fast MA's window, the</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># second the slow MA's window</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Initialize the strategy"""</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.fastma </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.slowma </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.cross&nbsp; </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python color1">self</code><code class="python plain">.params.optim:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Use a tuple during optimization</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.params.fast, </code><code class="python color1">self</code><code class="python plain">.params.slow </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.params.optim_fs&nbsp;&nbsp;&nbsp; </code><code class="python comments"># fast and slow replaced by tuple's contents</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python color1">self</code><code class="python plain">.params.fast &gt; </code><code class="python color1">self</code><code class="python plain">.params.slow:</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code> <code class="python plain">ValueError(</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"A SMAC strategy cannot have the fast moving average's window be "</code> <code class="python keyword">+</code> <code class="python plain">\</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"greater than the slow moving average window."</code><code class="python plain">)</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">d </code><code class="python keyword">in</code> <code class="python color1">self</code><code class="python plain">.getdatanames():</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># The moving averages</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.fastma[d] </code><code class="python keyword">=</code> <code class="python plain">btind.SimpleMovingAverage(</code><code class="python color1">self</code><code class="python plain">.getdatabyname(d),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># The symbol for the moving average</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">period</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.params.fast,&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Fast moving average</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plotname</code><code class="python keyword">=</code><code class="python string">"FastMA: "</code> <code class="python keyword">+</code> <code class="python plain">d)</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.slowma[d] </code><code class="python keyword">=</code> <code class="python plain">btind.SimpleMovingAverage(</code><code class="python color1">self</code><code class="python plain">.getdatabyname(d),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># The symbol for the moving average</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">period</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.params.slow,&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Slow moving average</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plotname</code><code class="python keyword">=</code><code class="python string">"SlowMA: "</code> <code class="python keyword">+</code> <code class="python plain">d)</code></div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># This is different; this is 1 when fast crosses above slow, -1 when fast crosses below slow, 0 o.w.</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.cross[d] </code><code class="python keyword">=</code> <code class="python plain">btind.CrossOver(</code><code class="python color1">self</code><code class="python plain">.fastma[d], </code><code class="python color1">self</code><code class="python plain">.slowma[d], plot</code><code class="python keyword">=</code><code class="python color1">False</code><code class="python plain">)</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python functions">next</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Define what will be done in a single step, including creating and closing trades"""</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">d </code><code class="python keyword">in</code> <code class="python color1">self</code><code class="python plain">.getdatanames():&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Looping through all symbols</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">pos </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.getpositionbyname(d).size </code><code class="python keyword">or</code> <code class="python value">0</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">pos </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python value">0</code><code class="python plain">:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Are we out of the market?</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># Consider the possibility of entrance</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python color1">self</code><code class="python plain">.cross[d][</code><code class="python value">0</code><code class="python plain">] &gt; </code><code class="python value">0</code><code class="python plain">:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># A buy signal</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.buy(data</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.getdatabyname(d))</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># We have an open position</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python color1">self</code><code class="python plain">.cross[d][</code><code class="python value">0</code><code class="python plain">] &lt; </code><code class="python value">0</code><code class="python plain">:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># A sell signal</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.sell(data</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.getdatabyname(d))</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="python keyword">class</code> <code class="python plain">PropSizer(bt.Sizer):</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""A position sizer that will buy as many stocks as necessary for a certain proportion of the portfolio</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">to be committed to the position, while allowing stocks to be bought in batches (say, 100)"""</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">params </code><code class="python keyword">=</code> <code class="python plain">{</code><code class="python string">"prop"</code><code class="python plain">: </code><code class="python value">0.1</code><code class="python plain">, </code><code class="python string">"batch"</code><code class="python plain">: </code><code class="python value">100</code><code class="python plain">}</code></div><div class="line number55 index54 alt2">&nbsp;</div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">_getsizing(</code><code class="python color1">self</code><code class="python plain">, comminfo, cash, data, isbuy):</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Returns the proper sizing"""</code></div><div class="line number58 index57 alt1">&nbsp;</div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">isbuy:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Buying</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">target </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.broker.getvalue() </code><code class="python keyword">*</code> <code class="python color1">self</code><code class="python plain">.params.prop&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Ideal total value of the position</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">price </code><code class="python keyword">=</code> <code class="python plain">data.close[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">shares_ideal </code><code class="python keyword">=</code> <code class="python plain">target </code><code class="python keyword">/</code> <code class="python plain">price&nbsp;&nbsp;&nbsp; </code><code class="python comments"># How many shares are needed to get target</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">batches </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(shares_ideal </code><code class="python keyword">/</code> <code class="python color1">self</code><code class="python plain">.params.batch)&nbsp;&nbsp;&nbsp; </code><code class="python comments"># How many batches is this trade?</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">shares </code><code class="python keyword">=</code> <code class="python plain">batches </code><code class="python keyword">*</code> <code class="python color1">self</code><code class="python plain">.params.batch&nbsp;&nbsp;&nbsp; </code><code class="python comments"># The actual number of shares bought</code></div><div class="line number65 index64 alt2">&nbsp;</div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">shares </code><code class="python keyword">*</code> <code class="python plain">price &gt; cash:</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python value">0</code>&nbsp;&nbsp;&nbsp; <code class="python comments"># Not enough money for this trade</code></div><div class="line number68 index67 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">shares</code></div><div class="line number70 index69 alt1">&nbsp;</div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Selling</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python color1">self</code><code class="python plain">.broker.getposition(data).size&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Clear the position</code></div><div class="line number73 index72 alt2">&nbsp;</div><div class="line number74 index73 alt1">&nbsp;</div><div class="line number75 index74 alt2"><code class="python keyword">class</code> <code class="python plain">AcctValue(bt.Observer):</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">alias </code><code class="python keyword">=</code> <code class="python plain">(</code><code class="python string">'Value'</code><code class="python plain">,)</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">lines </code><code class="python keyword">=</code> <code class="python plain">(</code><code class="python string">'value'</code><code class="python plain">,)</code></div><div class="line number78 index77 alt1">&nbsp;</div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">plotinfo </code><code class="python keyword">=</code> <code class="python plain">{</code><code class="python string">"plot"</code><code class="python plain">: </code><code class="python color1">True</code><code class="python plain">, </code><code class="python string">"subplot"</code><code class="python plain">: </code><code class="python color1">True</code><code class="python plain">}</code></div><div class="line number80 index79 alt1">&nbsp;</div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python functions">next</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.lines.value[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">._owner.broker.getvalue()&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Get today's account value (cash + stocks)</code></div><div class="line number83 index82 alt2">&nbsp;</div><div class="line number84 index83 alt1">&nbsp;</div><div class="line number85 index84 alt2"><code class="python keyword">class</code> <code class="python plain">AcctStats(bt.Analyzer):</code></div><div class="line number86 index85 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""A simple analyzer that gets the gain in the value of the account; should be self-explanatory"""</code></div><div class="line number87 index86 alt2">&nbsp;</div><div class="line number88 index87 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number89 index88 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.start_val </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()</code></div><div class="line number90 index89 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.end_val </code><code class="python keyword">=</code> <code class="python color1">None</code></div><div class="line number91 index90 alt2">&nbsp;</div><div class="line number92 index91 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">stop(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number93 index92 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.end_val </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()</code></div><div class="line number94 index93 alt1">&nbsp;</div><div class="line number95 index94 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">get_analysis(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number96 index95 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">{</code><code class="python string">"start"</code><code class="python plain">: </code><code class="python color1">self</code><code class="python plain">.start_val, </code><code class="python string">"end"</code><code class="python plain">: </code><code class="python color1">self</code><code class="python plain">.end_val,</code></div><div class="line number97 index96 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"growth"</code><code class="python plain">: </code><code class="python color1">self</code><code class="python plain">.end_val </code><code class="python keyword">-</code> <code class="python color1">self</code><code class="python plain">.start_val, </code><code class="python string">"return"</code><code class="python plain">: </code><code class="python color1">self</code><code class="python plain">.end_val </code><code class="python keyword">/</code> <code class="python color1">self</code><code class="python plain">.start_val}</code></div><div class="line number98 index97 alt1">&nbsp;</div><div class="line number99 index98 alt2">&nbsp;</div><div class="line number100 index99 alt1"><code class="python keyword">class</code> <code class="python plain">TimeSeriesSplitImproved(TimeSeriesSplit):</code></div><div class="line number101 index100 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Time Series cross-validator</code></div><div class="line number102 index101 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Provides train/test indices to split time series data samples</code></div><div class="line number103 index102 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">that are observed at fixed time intervals, in train/test sets.</code></div><div class="line number104 index103 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">In each split, test indices must be higher than before, and thus shuffling</code></div><div class="line number105 index104 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">in cross validator is inappropriate.</code></div><div class="line number106 index105 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">This cross-validation object is a variation of :class:`KFold`.</code></div><div class="line number107 index106 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">In the kth split, it returns first k folds as train set and the</code></div><div class="line number108 index107 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">(k+1)th fold as test set.</code></div><div class="line number109 index108 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Note that unlike standard cross-validation methods, successive</code></div><div class="line number110 index109 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">training sets are supersets of those that come before them.</code></div><div class="line number111 index110 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Read more in the :ref:`User Guide &lt;cross_validation&gt;`.</code></div><div class="line number112 index111 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Parameters</code></div><div class="line number113 index112 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">----------</code></div><div class="line number114 index113 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">n_splits : int, default=3</code></div><div class="line number115 index114 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Number of splits. Must be at least 1.</code></div><div class="line number116 index115 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Examples</code></div><div class="line number117 index116 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">--------</code></div><div class="line number118 index117 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; from sklearn.model_selection import TimeSeriesSplit</code></div><div class="line number119 index118 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [1, 2], [3, 4]])</code></div><div class="line number120 index119 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; y = np.array([1, 2, 3, 4])</code></div><div class="line number121 index120 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; tscv = TimeSeriesSplit(n_splits=3)</code></div><div class="line number122 index121 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; print(tscv)&nbsp; # doctest: +NORMALIZE_WHITESPACE</code></div><div class="line number123 index122 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TimeSeriesSplit(n_splits=3)</code></div><div class="line number124 index123 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; for train_index, test_index in tscv.split(X):</code></div><div class="line number125 index124 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp; print("TRAIN:", train_index, "TEST:", test_index)</code></div><div class="line number126 index125 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp; X_train, X_test = X[train_index], X[test_index]</code></div><div class="line number127 index126 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp; y_train, y_test = y[train_index], y[test_index]</code></div><div class="line number128 index127 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [0] TEST: [1]</code></div><div class="line number129 index128 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [0 1] TEST: [2]</code></div><div class="line number130 index129 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [0 1 2] TEST: [3]</code></div><div class="line number131 index130 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; for train_index, test_index in tscv.split(X, fixed_length=True):</code></div><div class="line number132 index131 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; print("TRAIN:", train_index, "TEST:", test_index)</code></div><div class="line number133 index132 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; X_train, X_test = X[train_index], X[test_index]</code></div><div class="line number134 index133 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; y_train, y_test = y[train_index], y[test_index]</code></div><div class="line number135 index134 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [0] TEST: [1]</code></div><div class="line number136 index135 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [1] TEST: [2]</code></div><div class="line number137 index136 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [2] TEST: [3]</code></div><div class="line number138 index137 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">&gt;&gt;&gt; for train_index, test_index in tscv.split(X, fixed_length=True,</code></div><div class="line number139 index138 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; train_splits=2):</code></div><div class="line number140 index139 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; print("TRAIN:", train_index, "TEST:", test_index)</code></div><div class="line number141 index140 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; X_train, X_test = X[train_index], X[test_index]</code></div><div class="line number142 index141 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">...&nbsp;&nbsp;&nbsp;&nbsp; y_train, y_test = y[train_index], y[test_index]</code></div><div class="line number143 index142 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [0 1] TEST: [2]</code></div><div class="line number144 index143 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TRAIN: [1 2] TEST: [3]</code></div><div class="line number145 index144 alt2">&nbsp;</div><div class="line number146 index145 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Notes</code></div><div class="line number147 index146 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">-----</code></div><div class="line number148 index147 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">When ``fixed_length`` is ``False``, the training set has size</code></div><div class="line number149 index148 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">``i * train_splits * n_samples // (n_splits + 1) + n_samples %</code></div><div class="line number150 index149 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">(n_splits + 1)`` in the ``i``th split, with a test set of size</code></div><div class="line number151 index150 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">``n_samples//(n_splits + 1) * test_splits``, where ``n_samples``</code></div><div class="line number152 index151 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">is the number of samples. If fixed_length is True, replace ``i``</code></div><div class="line number153 index152 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">in the above formulation with 1, and ignore ``n_samples %</code></div><div class="line number154 index153 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">(n_splits + 1)`` except for the first training set. The number</code></div><div class="line number155 index154 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">of test sets is ``n_splits + 2 - train_splits - test_splits``.</code></div><div class="line number156 index155 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number157 index156 alt2">&nbsp;</div><div class="line number158 index157 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">split(</code><code class="python color1">self</code><code class="python plain">, X, y</code><code class="python keyword">=</code><code class="python color1">None</code><code class="python plain">, groups</code><code class="python keyword">=</code><code class="python color1">None</code><code class="python plain">, fixed_length</code><code class="python keyword">=</code><code class="python color1">False</code><code class="python plain">,</code></div><div class="line number159 index158 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">train_splits</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">, test_splits</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">):</code></div><div class="line number160 index159 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Generate indices to split data into training and test set.</code></div><div class="line number161 index160 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Parameters</code></div><div class="line number162 index161 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">----------</code></div><div class="line number163 index162 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">X : array-like, shape (n_samples, n_features)</code></div><div class="line number164 index163 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Training data, where n_samples is the number of samples</code></div><div class="line number165 index164 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">and n_features is the number of features.</code></div><div class="line number166 index165 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">y : array-like, shape (n_samples,)</code></div><div class="line number167 index166 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Always ignored, exists for compatibility.</code></div><div class="line number168 index167 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">groups : array-like, with shape (n_samples,), optional</code></div><div class="line number169 index168 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Always ignored, exists for compatibility.</code></div><div class="line number170 index169 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">fixed_length : bool, hether training sets should always have</code></div><div class="line number171 index170 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">common length</code></div><div class="line number172 index171 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">train_splits : positive int, for the minimum number of</code></div><div class="line number173 index172 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">splits to include in training sets</code></div><div class="line number174 index173 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">test_splits : positive int, for the number of splits to</code></div><div class="line number175 index174 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">include in the test set</code></div><div class="line number176 index175 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Returns</code></div><div class="line number177 index176 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">-------</code></div><div class="line number178 index177 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">train : ndarray</code></div><div class="line number179 index178 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">The training set indices for that split.</code></div><div class="line number180 index179 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">test : ndarray</code></div><div class="line number181 index180 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">The testing set indices for that split.</code></div><div class="line number182 index181 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number183 index182 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">X, y, groups </code><code class="python keyword">=</code> <code class="python plain">indexable(X, y, groups)</code></div><div class="line number184 index183 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">n_samples </code><code class="python keyword">=</code> <code class="python plain">_num_samples(X)</code></div><div class="line number185 index184 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">n_splits </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.n_splits</code></div><div class="line number186 index185 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">n_folds </code><code class="python keyword">=</code> <code class="python plain">n_splits </code><code class="python keyword">+</code> <code class="python value">1</code></div><div class="line number187 index186 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">train_splits, test_splits </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(train_splits), </code><code class="python functions">int</code><code class="python plain">(test_splits)</code></div><div class="line number188 index187 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">n_folds &gt; n_samples:</code></div><div class="line number189 index188 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code> <code class="python plain">ValueError(</code></div><div class="line number190 index189 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(</code><code class="python string">"Cannot have number of folds ={0} greater"</code></div><div class="line number191 index190 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">" than the number of samples: {1}."</code><code class="python plain">).</code><code class="python functions">format</code><code class="python plain">(n_folds,</code></div><div class="line number192 index191 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">n_samples))</code></div><div class="line number193 index192 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">(n_folds </code><code class="python keyword">-</code> <code class="python plain">train_splits </code><code class="python keyword">-</code> <code class="python plain">test_splits) &lt; </code><code class="python value">0</code><code class="python plain">:</code></div><div class="line number194 index193 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code> <code class="python plain">ValueError(</code></div><div class="line number195 index194 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(</code><code class="python string">"Cannot have more training and testing splits than "</code></div><div class="line number196 index195 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"there are splits in total."</code><code class="python plain">))</code></div><div class="line number197 index196 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python keyword">not</code> <code class="python plain">(train_splits &gt; </code><code class="python value">0</code> <code class="python keyword">and</code> <code class="python plain">test_splits &gt; </code><code class="python value">0</code><code class="python plain">):</code></div><div class="line number198 index197 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code> <code class="python plain">ValueError(</code></div><div class="line number199 index198 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">(</code><code class="python string">"Both train_splits and test_splits must be positive"</code></div><div class="line number200 index199 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">" integers."</code><code class="python plain">))</code></div><div class="line number201 index200 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">indices </code><code class="python keyword">=</code> <code class="python plain">np.arange(n_samples)</code></div><div class="line number202 index201 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">split_size </code><code class="python keyword">=</code> <code class="python plain">(n_samples </code><code class="python keyword">/</code><code class="python keyword">/</code> <code class="python plain">n_folds)</code></div><div class="line number203 index202 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">test_size </code><code class="python keyword">=</code> <code class="python plain">split_size </code><code class="python keyword">*</code> <code class="python plain">test_splits</code></div><div class="line number204 index203 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">train_size </code><code class="python keyword">=</code> <code class="python plain">split_size </code><code class="python keyword">*</code> <code class="python plain">train_splits</code></div><div class="line number205 index204 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">test_starts </code><code class="python keyword">=</code> <code class="python functions">range</code><code class="python plain">(train_size </code><code class="python keyword">+</code> <code class="python plain">n_samples </code><code class="python keyword">%</code> <code class="python plain">n_folds,</code></div><div class="line number206 index205 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">n_samples </code><code class="python keyword">-</code> <code class="python plain">(test_size </code><code class="python keyword">-</code> <code class="python plain">split_size),</code></div><div class="line number207 index206 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">split_size)</code></div><div class="line number208 index207 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">fixed_length:</code></div><div class="line number209 index208 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">i, test_start </code><code class="python keyword">in</code> <code class="python functions">zip</code><code class="python plain">(</code><code class="python functions">range</code><code class="python plain">(</code><code class="python functions">len</code><code class="python plain">(test_starts)),</code></div><div class="line number210 index209 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">test_starts):</code></div><div class="line number211 index210 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">rem </code><code class="python keyword">=</code> <code class="python value">0</code></div><div class="line number212 index211 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">i </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python value">0</code><code class="python plain">:</code></div><div class="line number213 index212 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">rem </code><code class="python keyword">=</code> <code class="python plain">n_samples </code><code class="python keyword">%</code> <code class="python plain">n_folds</code></div><div class="line number214 index213 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">yield</code> <code class="python plain">(indices[(test_start </code><code class="python keyword">-</code> <code class="python plain">train_size </code><code class="python keyword">-</code> <code class="python plain">rem):test_start],</code></div><div class="line number215 index214 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">indices[test_start:test_start </code><code class="python keyword">+</code> <code class="python plain">test_size])</code></div><div class="line number216 index215 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number217 index216 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">test_start </code><code class="python keyword">in</code> <code class="python plain">test_starts:</code></div><div class="line number218 index217 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">yield</code> <code class="python plain">(indices[:test_start],</code></div><div class="line number219 index218 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">indices[test_start:test_start </code><code class="python keyword">+</code> <code class="python plain">test_size])</code></div></div></td></tr></tbody></table></div></div>
<p>Let’s create a <code>Cerebro</code> instance with everything added save for the analyzers.</p>
<div><div id="highlighter_985469" class="syntaxhighlighter   python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">start </code><code class="python keyword">=</code> <code class="python plain">dt.datetime(</code><code class="python value">2010</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">, </code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number2 index1 alt1"><code class="python plain">end </code><code class="python keyword">=</code> <code class="python plain">dt.datetime(</code><code class="python value">2016</code><code class="python plain">, </code><code class="python value">10</code><code class="python plain">, </code><code class="python value">31</code><code class="python plain">)</code></div><div class="line number3 index2 alt2"><code class="python plain">symbols </code><code class="python keyword">=</code> <code class="python plain">[</code><code class="python string">"AAPL"</code><code class="python plain">, </code><code class="python string">"GOOG"</code><code class="python plain">, </code><code class="python string">"MSFT"</code><code class="python plain">, </code><code class="python string">"AMZN"</code><code class="python plain">, </code><code class="python string">"YHOO"</code><code class="python plain">, </code><code class="python string">"SNY"</code><code class="python plain">, </code><code class="python string">"VZ"</code><code class="python plain">, </code><code class="python string">"IBM"</code><code class="python plain">, </code><code class="python string">"HPQ"</code><code class="python plain">, </code><code class="python string">"QCOM"</code><code class="python plain">, </code><code class="python string">"NVDA"</code><code class="python plain">]</code></div><div class="line number4 index3 alt1"><code class="python plain">datafeeds </code><code class="python keyword">=</code> <code class="python plain">{s: web.DataReader(s, </code><code class="python string">"google"</code><code class="python plain">, start, end) </code><code class="python keyword">for</code> <code class="python plain">s </code><code class="python keyword">in</code> <code class="python plain">symbols}</code></div><div class="line number5 index4 alt2"><code class="python keyword">for</code> <code class="python plain">df </code><code class="python keyword">in</code> <code class="python plain">datafeeds.values():</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">df[</code><code class="python string">"OpenInterest"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python value">0</code>&nbsp;&nbsp;&nbsp; <code class="python comments"># PandasData reader expects an OpenInterest column;</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># not provided by Google and we don't use it so set to 0</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="python plain">cerebro </code><code class="python keyword">=</code> <code class="python plain">bt.Cerebro(stdstats</code><code class="python keyword">=</code><code class="python color1">False</code><code class="python plain">)</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python plain">plot_symbols </code><code class="python keyword">=</code> <code class="python plain">[</code><code class="python string">"AAPL"</code><code class="python plain">, </code><code class="python string">"GOOG"</code><code class="python plain">, </code><code class="python string">"NVDA"</code><code class="python plain">]</code></div><div class="line number12 index11 alt1"><code class="python plain">is_first </code><code class="python keyword">=</code> <code class="python color1">True</code></div><div class="line number13 index12 alt2"><code class="python comments">#plot_symbols = []</code></div><div class="line number14 index13 alt1"><code class="python keyword">for</code> <code class="python plain">s, df </code><code class="python keyword">in</code> <code class="python plain">datafeeds.items():</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">bt.feeds.PandasData(dataname</code><code class="python keyword">=</code><code class="python plain">df, name</code><code class="python keyword">=</code><code class="python plain">s)</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">s </code><code class="python keyword">in</code> <code class="python plain">plot_symbols:</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">is_first:</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data_main_plot </code><code class="python keyword">=</code> <code class="python plain">data</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">is_first </code><code class="python keyword">=</code> <code class="python color1">False</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data.plotinfo.plotmaster </code><code class="python keyword">=</code> <code class="python plain">data_main_plot</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data.plotinfo.plot </code><code class="python keyword">=</code> <code class="python color1">False</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">cerebro.adddata(data)</code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="python plain">cerebro.broker.setcash(</code><code class="python value">1000000</code><code class="python plain">)</code></div><div class="line number27 index26 alt2"><code class="python plain">cerebro.broker.setcommission(</code><code class="python value">0.02</code><code class="python plain">)</code></div><div class="line number28 index27 alt1"><code class="python plain">cerebro.addstrategy(SMAC)</code></div><div class="line number29 index28 alt2"><code class="python plain">cerebro.addobserver(AcctValue)</code></div><div class="line number30 index29 alt1"><code class="python plain">cerebro.addobservermulti(bt.observers.BuySell)</code></div><div class="line number31 index30 alt2"><code class="python plain">cerebro.addsizer(PropSizer)</code></div></div></td></tr></tbody></table></div></div>
<p>We add <code>Analyzer</code> objects to <code>Cerebro</code> instances with the <code>addanalyzer()</code> method. The objects collect data while the strategy is running then produce final statistics that users can then review by calling the <code>Analyzer</code>‘s <code>get_analysis()</code> method. These objects are intended to be light-weight, containing only the statistics requested and not the data used to generate the statistics. Usually they return ordered dictionaries containing the statics computed for the strategy.</p>
<p>Some of the built-in analyzers I use include:</p>
<ul>
<li><code>TradeAnalyzer</code>: This computes trade statistics, such as the number of open and closed trades, total and average profit/loss from trades, how long trades are in the market, the longest streaks (successive winning or losing trades), and other similar statistics.</li>
<li><code>Returns</code>: This computes total, average, compound, and annualized (normalized to represent returns over a year) returns, which is the growth of the portfolio.</li>
<li><code>DrawDown</code>: This computes drawdown statistics. Drawdown is how much the value of an investment or account decreases after reaching a new high, from “peak” (the high point) to “trough” (the low point). Investors and traders dislike high drawdown, and thus are interested in metrics such as the average drawdown, the maximum draw down (the biggest gap between peak and trough), and the average and maximum length of a drawdown period (which is the period between a new high and the previous high), which this analyzer computes. Traders would like average drawdowns to be small and don’t want to wait long for the next high to be reached. (Traders often cite maximum drawdown, but beware; as the timeframe increases, <em>maximum</em> drawdown, by definition, can only increase, and thus should not be interpreted separately from the duration of time considered.)</li>
</ul>
<p><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/spymaxdrawdownillustration.png" alt="Max Drawdown Illustration" width="605" height="400" srcset="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=605&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/spymaxdrawdownillustration.png?w=680" scale="2"><br>
<em><a href="https://www.google.com/finance?q=NYSEARCA:SPY">SPY</a> max drawdown from January 2010 to June 2017, with maximum drawdown and a new peak illustrated. I created this chart using Google Finance data obtained in R via <strong>quantmod</strong> and using <strong>PerformanceAnalytics</strong>.</em></p>
<ul>
<li><code>SharpeRatio_A</code>: This computes the annualized Sharpe ratio. The <a href="http://www.investopedia.com/terms/s/sharperatio.asp">Sharpe ratio</a> is the most common risk-adjusted performance measure of an investment used. It is excess returns (which is return on investment minus the <a href="http://www.investopedia.com/terms/r/risk-freerate.asp">“risk-free” rate of return</a>, the latter often being the return of some US government debt instruments such as <a href="http://www.investopedia.com/terms/t/treasurybill.asp">T-bills</a>) divided by the standard deviation of the returns of the investment. The higher the Sharpe ratio, the better the return of the investment relative to its volatility (which is the type of risk considered). The annualized variant of the Sharpe ratio simply annualizes the metrics used in the computation.</li>
</ul>
<p>I attempted to use another analyzer, <code>AnnualReturn</code>, which computes annualized return metrics, but unfortunately it does not seem to work.</p>
<p>These analyzers are all useful, but we can easily create custom ones for new performance metrics not already implemented by subclassing from the <code>Analyzer</code> class. I did this in <a href="https://ntguardian.wordpress.com/2017/06/19/walk-forward-analysis-demonstration-backtrader/">my blog post on walk-forward analysis</a>. Usually creating a new analyzer involves:</p>
<ol>
<li>Creating modifiable parameters with a <code>params</code> dictionary declared at the beginning of the definition of the new analyzer</li>
<li>Defining an <code>__init__()</code> method setting up any variables needed when the analyzer is created or the backtest starts</li>
<li>Defining a <code>next()</code> method that gets any information needed during the backtest</li>
<li>Defining a <code>stop()</code> method for final computations</li>
<li>Defining a <code>get_analysis()</code> method that a user can call after a backtest that returns, say, a dictionary with all the statistics the analyzer computed</li>
</ol>
<p>In truth, only the <code>__init__()</code>, <code>stop()</code>, and <code>get_analysis()</code> methods are truly needed for an analyzer. Furthermore, analyzers should be light-weight; they do not need to include the entire backtest’s data to work after the backtest is completed.</p>
<h2>Using R’s PerformanceAnalytics Package in Python</h2>
<p>I have <a href="https://ntguardian.wordpress.com/2017/05/22/the-end-of-the-honeymoon-falling-out-of-love-with-quantstrat/">complaints about <strong>quantstrat</strong></a>, the most notable backtesting package for R, but R has many other packages useful for finance, such as <strong>quantmod</strong> or <strong>PerformanceAnalytics</strong>. In particular, <strong>PerformanceAnalytics</strong> has <a href="https://cran.r-project.org/web/packages/PerformanceAnalytics/PerformanceAnalytics.pdf">a lot of analytics functions</a> not provided by <strong>backtrader</strong> and likely without a Python equivalent.</p>
<p>Fortunately we can easily create a <strong>backtrader</strong> <code>Analyzer</code> that uses <strong>PerformanceAnalytics</strong> functions. I used the following template:</p>
<ol>
<li>Interface with R using <a href="https://rpy2.readthedocs.io/en/version_2.8.x/overview.html"><strong>rpy2</strong></a>, an excellent R interface for Python that gives Python users access to R functions</li>
<li>Use <code>importr()</code> to import the R package needed (in this case, <strong>PerformanceAnalytics</strong>), and use <code>numpy2ri</code> and <code>pandas2ri</code> so that <strong>NumPy</strong> <code>ndarray</code>s and <strong>pandas</strong> <code>Series</code> and <code>DataFrame</code>s can be translated into their R equivalents</li>
<li>In the <code>Analyzer</code>, record the data of interest in the <code>next()</code> method so that it can be transformed into a <strong>pandas</strong> <code>Series</code> containing a time series, with a <code>dict</code></li>
<li>In the <code>stop()</code> method, transform this <code>dict</code> into a <code>Series</code>, then use the R function from the imported library to compute the desired metric, passing the function the <code>Series</code> of data (this will be interpreted as an R vector, which can also be interpreted as an R <code>ts</code> time series thanks to the date index)</li>
<li>Save the results and delete the <code>dict</code> of data since it is no longer needed, and in <code>get_analysis()</code>, just return a <code>dict</code> containing the resulting calculation.</li>
</ol>
<p><strong>rpy2</strong> integrates R objects quite well, using a familiar Python-like interface. <strong>pandas</strong>, being initially inspired by R, also integrates well. In fact, the <strong>pandas</strong> objects <code>Series</code> and <code>DataFrame</code> were designed initially for storing and manipulating time series data, so do as well a job as, say, R’s <strong>xts</strong> package.</p>
<p>Here, I use <strong>PerformanceAnalytics</strong> to create analyzers calculating two more metrics not provided by <strong>backtrader</strong>. They are:</p>
<ul>
<li><code>VaR</code>: This computes value at risk (abbreviated VaR, and the capitalization here matters, distinguishing value at risk from variance and vector autoregression, which are abbreviated with var and VAR respectively). <a href="http://www.investopedia.com/terms/v/var.asp">Value at risk</a> measures the potential loss a portfolio could see. Different ways to precisely define and calculate VaR exist, but in spirit they all give how much money could be lost at a certain likelihood. For example, if the daily 95% VaR for a portfolio is -1%, then 95% of the time the portfolio’s daily return will exceed -1% (a loss of 1%), or 5% of the time losses will exceed 1% of the portfolio’s value. This could be useful information for, say, position sizing. This <code>Analyzer</code> is based on <strong>PerformanceAnalytics</strong> <code>VaR</code> function.</li>
<li><code>SortinoRatio</code>: This computes the account’s Sortino ratio. The <a href="http://www.investopedia.com/terms/s/sortinoratio.asp">Sortino ratio</a> is another risk-adjusted performance metric often presented as an alternative to the Sharpe ratio. It’s like the Sharpe ratio, but instead of dividing by the standard deviation of returns–which could punish volitility in the <em>positive</em> direction, which earns money–excess returns are divided by the standard deviation of losses alone. This is based on the <strong>PerformanceAnalytics</strong> function <code>SortinoRatio</code>.</li>
</ul>
<p>My analyzers work with log returns, or <img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/latex.php" alt="\log(x_t) - \log(x_{t - 1})" title="\log(x_t) - \log(x_{t - 1})" class="latex" width="130" height="18" srcset="https://s0.wp.com/latex.php?latex=%5Clog%28x_t%29+-+%5Clog%28x_%7Bt+-+1%7D%29&amp;bg=ffffff&amp;fg=444444&amp;s=0&amp;zoom=2 2x" scale="2">, which are my preferred way of computing returns. The definition of these analyzers is below. (Steps 1 and 2 of the process I outlined above were done when I loaded in all the packages I would be using in this article.) Notice that I included parameters that can be passed on to the respective <strong>PerformanceAnalytics</strong> functions (not all of the parameters, but the ones I most likely would want to change).</p>
<div><div id="highlighter_537095" class="syntaxhighlighter   python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">class</code> <code class="python plain">VaR(bt.Analyzer):</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Computes the value at risk metric for the whole account using the strategy, based on the R package</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">PerformanceAnalytics VaR function</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">params </code><code class="python keyword">=</code> <code class="python plain">{</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"p"</code><code class="python plain">: </code><code class="python value">0.95</code><code class="python plain">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Confidence level of calculation</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"method"</code><code class="python plain">: </code><code class="python string">"historical"</code>&nbsp;&nbsp;&nbsp; <code class="python comments"># Method used; can be "historical", "gaussian", "modified", "kernel"</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_return </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_last </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.vardict </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python functions">next</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python functions">len</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">.data) &gt; </code><code class="python value">1</code><code class="python plain">:</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">curdate </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.datetime.date(</code><code class="python value">0</code><code class="python plain">)</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># I use log returns</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_return[curdate] </code><code class="python keyword">=</code> <code class="python plain">np.log(</code><code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()) </code><code class="python keyword">-</code> <code class="python plain">np.log(</code><code class="python color1">self</code><code class="python plain">.acct_last)</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_last </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">stop(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs </code><code class="python keyword">=</code> <code class="python plain">Series(</code><code class="python color1">self</code><code class="python plain">.acct_return)&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Need to pass a time-series-like object to VaR</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs.sort_index(inplace</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.vardict[</code><code class="python string">"VaR"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">pa.VaR(srs, p</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.params.p, method</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.params.method)[</code><code class="python value">0</code><code class="python plain">]&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Get VaR</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">del</code> <code class="python color1">self</code><code class="python plain">.acct_return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># This dict is of no use to us anymore</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">get_analysis(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python color1">self</code><code class="python plain">.vardict</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="python keyword">class</code> <code class="python plain">SortinoRatio(bt.Analyzer):</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">Computes the Sortino ratio metric for the whole account using the strategy, based on the R package</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">PerformanceAnalytics SortinoRatio function</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">params </code><code class="python keyword">=</code> <code class="python plain">{</code><code class="python string">"MAR"</code><code class="python plain">: </code><code class="python value">0</code><code class="python plain">}&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Minimum Acceptable Return (perhaps the risk-free rate?); must be in same periodicity</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># as data</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_return </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_last </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.sortinodict </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">()</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python functions">next</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python functions">len</code><code class="python plain">(</code><code class="python color1">self</code><code class="python plain">.data) &gt; </code><code class="python value">1</code><code class="python plain">:</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># I use log returns</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">curdate </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.datetime.date(</code><code class="python value">0</code><code class="python plain">)</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_return[curdate] </code><code class="python keyword">=</code> <code class="python plain">np.log(</code><code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()) </code><code class="python keyword">-</code> <code class="python plain">np.log(</code><code class="python color1">self</code><code class="python plain">.acct_last)</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.acct_last </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.strategy.broker.get_value()</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">stop(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs </code><code class="python keyword">=</code> <code class="python plain">Series(</code><code class="python color1">self</code><code class="python plain">.acct_return)&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Need to pass a time-series-like object to SortinoRatio</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">srs.sort_index(inplace</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">)</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.sortinodict[</code><code class="python string">'sortinoratio'</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">pa.SortinoRatio(srs, MAR </code><code class="python keyword">=</code> <code class="python color1">self</code><code class="python plain">.params.MAR)[</code><code class="python value">0</code><code class="python plain">]&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Get Sortino Ratio</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">del</code> <code class="python color1">self</code><code class="python plain">.acct_return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># This dict is of no use to us anymore</code></div><div class="line number58 index57 alt1">&nbsp;</div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">get_analysis(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python color1">self</code><code class="python plain">.sortinodict</code></div></div></td></tr></tbody></table></div></div>
<h2>Seeing Analyzer Results</h2>
<p>I attach all my analyzers, along with the <code>PyFolio</code> <code>Analyzer</code>, which is needed for <strong>PyFolio</strong> integration (which I discuss later).</p>
<div><div id="highlighter_6533" class="syntaxhighlighter   python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">cerebro.addanalyzer(btanal.PyFolio)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Needed to use PyFolio</code></div><div class="line number2 index1 alt1"><code class="python plain">cerebro.addanalyzer(btanal.TradeAnalyzer)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Analyzes individual trades</code></div><div class="line number3 index2 alt2"><code class="python plain">cerebro.addanalyzer(btanal.SharpeRatio_A)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Gets the annualized Sharpe ratio</code></div><div class="line number4 index3 alt1"><code class="python comments">#cerebro.addanalyzer(btanal.AnnualReturn)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # Annualized returns (does not work?)</code></div><div class="line number5 index4 alt2"><code class="python plain">cerebro.addanalyzer(btanal.Returns)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Returns</code></div><div class="line number6 index5 alt1"><code class="python plain">cerebro.addanalyzer(btanal.DrawDown)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Drawdown statistics</code></div><div class="line number7 index6 alt2"><code class="python plain">cerebro.addanalyzer(VaR)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Value at risk</code></div><div class="line number8 index7 alt1"><code class="python plain">cerebro.addanalyzer(SortinoRatio, MAR</code><code class="python keyword">=</code><code class="python value">0.00004</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Sortino ratio with risk-free rate of 0.004% daily (~1% annually)</code></div></div></td></tr></tbody></table></div></div>
<p>Then I run the strategy. Notice that I save the results in <code>res</code>. This must be done in order to see the <code>Analyzer</code>s results.</p>
<div><div id="highlighter_459875" class="syntaxhighlighter   python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res </code><code class="python keyword">=</code> <code class="python plain">cerebro.run()</code></div></div></td></tr></tbody></table></div></div>
<p>Getting the statistics I want is now easy. That said, notice their presentation.</p>
<div><div id="highlighter_214721" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.tradeanalyzer.get_analysis()</code></div></div></td></tr></tbody></table></div></div>
<pre><code>AutoOrderedDict([('total',
                  AutoOrderedDict([('total', 197),
                                   ('open', 5),
                                   ('closed', 192)])),
                 ('streak',
                  AutoOrderedDict([('won',
                                    AutoOrderedDict([('current', 2),
                                                     ('longest', 5)])),
                                   ('lost',
                                    AutoOrderedDict([('current', 0),
                                                     ('longest', 18)]))])),
                 ('pnl',
                  AutoOrderedDict([('gross',
                                    AutoOrderedDict([('total',
                                                      222396.9999999999),
                                                     ('average',
                                                      1158.3177083333328)])),
                                   ('net',
                                    AutoOrderedDict([('total',
                                                      -373899.18000000005),
                                                     ('average',
                                                      -1947.3915625000002)]))])),
                 ('won',
                  AutoOrderedDict([('total', 55),
                                   ('pnl',
                                    AutoOrderedDict([('total',
                                                      506889.75999999995),
                                                     ('average',
                                                      9216.177454545454),
                                                     ('max',
                                                      59021.960000000014)]))])),
                 ('lost',
                  AutoOrderedDict([('total', 137),
                                   ('pnl',
                                    AutoOrderedDict([('total',
                                                      -880788.9400000004),
                                                     ('average',
                                                      -6429.116350364967),
                                                     ('max',
                                                      -17297.76000000001)]))])),
                 ('long',
                  AutoOrderedDict([('total', 192),
                                   ('pnl',
                                    AutoOrderedDict([('total',
                                                      -373899.18000000005),
                                                     ('average',
                                                      -1947.3915625000002),
                                                     ('won',
                                                      AutoOrderedDict([('total',
                                                                        506889.75999999995),
                                                                       ('average',
                                                                        9216.177454545454),
                                                                       ('max',
                                                                        59021.960000000014)])),
                                                     ('lost',
                                                      AutoOrderedDict([('total',
                                                                        -880788.9400000004),
                                                                       ('average',
                                                                        -6429.116350364967),
                                                                       ('max',
                                                                        -17297.76000000001)]))])),
                                   ('won', 55),
                                   ('lost', 137)])),
                 ('short',
                  AutoOrderedDict([('total', 0),
                                   ('pnl',
                                    AutoOrderedDict([('total', 0.0),
                                                     ('average', 0.0),
                                                     ('won',
                                                      AutoOrderedDict([('total',
                                                                        0.0),
                                                                       ('average',
                                                                        0.0),
                                                                       ('max',
                                                                        0.0)])),
                                                     ('lost',
                                                      AutoOrderedDict([('total',
                                                                        0.0),
                                                                       ('average',
                                                                        0.0),
                                                                       ('max',
                                                                        0.0)]))])),
                                   ('won', 0),
                                   ('lost', 0)])),
                 ('len',
                  AutoOrderedDict([('total', 9604),
                                   ('average', 50.020833333333336),
                                   ('max', 236),
                                   ('min', 1),
                                   ('won',
                                    AutoOrderedDict([('total', 5141),
                                                     ('average',
                                                      93.47272727272727),
                                                     ('max', 236),
                                                     ('min', 45)])),
                                   ('lost',
                                    AutoOrderedDict([('total', 4463),
                                                     ('average',
                                                      32.57664233576642),
                                                     ('max', 95),
                                                     ('min', 1)])),
                                   ('long',
                                    AutoOrderedDict([('total', 9604),
                                                     ('average',
                                                      50.020833333333336),
                                                     ('max', 236),
                                                     ('min', 1),
                                                     ('won',
                                                      AutoOrderedDict([('total',
                                                                        5141),
                                                                       ('average',
                                                                        93.47272727272727),
                                                                       ('max',
                                                                        236),
                                                                       ('min',
                                                                        45)])),
                                                     ('lost',
                                                      AutoOrderedDict([('total',
                                                                        4463),
                                                                       ('average',
                                                                        32.57664233576642),
                                                                       ('max',
                                                                        95),
                                                                       ('min',
                                                                        1)]))])),
                                   ('short',
                                    AutoOrderedDict([('total', 0),
                                                     ('average', 0.0),
                                                     ('max', 0),
                                                     ('min', 2147483647),
                                                     ('won',
                                                      AutoOrderedDict([('total',
                                                                        0),
                                                                       ('average',
                                                                        0.0),
                                                                       ('max',
                                                                        0),
                                                                       ('min',
                                                                        2147483647)])),
                                                     ('lost',
                                                      AutoOrderedDict([('total',
                                                                        0),
                                                                       ('average',
                                                                        0.0),
                                                                       ('max',
                                                                        0),
                                                                       ('min',
                                                                        2147483647)]))]))]))])
</code></pre>
<div><div id="highlighter_927360" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.sharperatio_a.get_analysis()</code></div></div></td></tr></tbody></table></div></div>
<pre><code>OrderedDict([('sharperatio', -0.5028399674826421)])
</code></pre>
<div><div id="highlighter_421407" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.returns.get_analysis()</code></div></div></td></tr></tbody></table></div></div>
<pre><code>OrderedDict([('rtot', -0.3075714139075255),
             ('ravg', -0.0001788205894811195),
             ('rnorm', -0.04406254197743979),
             ('rnorm100', -4.406254197743979)])
</code></pre>
<div><div id="highlighter_835788" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.drawdown.get_analysis()</code></div></div></td></tr></tbody></table></div></div>
<pre><code>AutoOrderedDict([('len', 1435),
                 ('drawdown', 32.8390619071308),
                 ('moneydown', 359498.7800000005),
                 ('max',
                  AutoOrderedDict([('len', 1435),
                                   ('drawdown', 41.29525957443689),
                                   ('moneydown', 452071.2400000006)]))])
</code></pre>
<div><div id="highlighter_28205" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.var.get_analysis()</code></div></div></td></tr></tbody></table></div></div>
<pre><code>{'VaR': -0.011894285243688957}
</code></pre>
<div><div id="highlighter_738765" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.sortinoratio.get_analysis()</code></div></div></td></tr></tbody></table></div></div>
<pre><code>{'sortinoratio': -0.04122331025349434}
</code></pre>
<p>This is, technically, all the data I want. This works fine if you don’t care about presentation and if the results are going to be processed and presented by something else. That being said, if you’re working in an interactive environment such as a Jupyter notebook (as I did when writing this article) and are used to pretty printing of tables and charts, you may be disappointed to see the results in long dictionaries. This presentation is barely useful.</p>
<p>Thus, in a notebook environment, you may want to see this data in a more consumable format. This would be where you want to use <strong>PyFolio</strong>.</p>
<h2>PyFolio and backtrader</h2>
<p><a href="https://quantopian.github.io/pyfolio/"><strong>PyFolio</strong></a> is a Python library for portfolio analytics. <strong>PyFolio</strong> creates “tear sheets” or tables and graphics of portfolio analytics that give most desired metrics describing the performance of a strategy in a clean, consumable format. It works nicely in an interactive notebook setting.</p>
<p><strong>PyFolio</strong> was designed mainly to work with the <a href="http://www.zipline.io/"><strong>zipline</strong></a> backtesting platform (perhaps the more common Python backtesting platform, and one that, on reviewing its documentation, I’m not that impressed with) and with <a href="https://www.quantopian.com/">Quantopian</a>, which aspires to be the <a href="https://www.kaggle.com/">Kaggle</a> of algorithmic trading and a crowd-sourced hedge fund, providing a platform for algorithm development and putting real money behind strong performers (and paying their creators). While <strong>zipline</strong> is <strong>PyFolio</strong>‘s target, <strong>backtrader</strong> can work with <strong>PyFolio</strong> as well. <strong>PyFolio</strong> needs only four datasets to create a tear sheet: the returns, positions, transactions, and gross leverage of a strategy as it proceeds. The <code>PyFolio</code> <code>Analyzer</code> creates these metrics from a backtest, which can then be passed on to a <strong>PyFolio</strong> function like so:</p>
<div><div id="highlighter_386266" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">returns, positions, transactions, gross_lev </code><code class="python keyword">=</code> <code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers.pyfolio.get_pf_items()</code></div><div class="line number2 index1 alt1"><code class="python plain">pf.create_round_trip_tear_sheet(returns, positions, transactions)</code></div></div></td></tr></tbody></table></div></div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Summary stats</th>
<th>All trades</th>
<th>Long trades</th>
</tr>
</thead>
<tbody>
<tr>
<th>Total number of round_trips</th>
<td>193.00</td>
<td>193.00</td>
</tr>
<tr>
<th>Percent profitable</th>
<td>0.43</td>
<td>0.43</td>
</tr>
<tr>
<th>Winning round_trips</th>
<td>83.00</td>
<td>83.00</td>
</tr>
<tr>
<th>Losing round_trips</th>
<td>110.00</td>
<td>110.00</td>
</tr>
<tr>
<th>Even round_trips</th>
<td>0.00</td>
<td>0.00</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>PnL stats</th>
<th>All trades</th>
<th>Long trades</th>
</tr>
</thead>
<tbody>
<tr>
<th>Total profit</th>
<td>$300657.00</td>
<td>$300657.00</td>
</tr>
<tr>
<th>Gross profit</th>
<td>$794165.00</td>
<td>$794165.00</td>
</tr>
<tr>
<th>Gross loss</th>
<td>$-493508.00</td>
<td>$-493508.00</td>
</tr>
<tr>
<th>Profit factor</th>
<td>$1.61</td>
<td>$1.61</td>
</tr>
<tr>
<th>Avg. trade net profit</th>
<td>$1557.81</td>
<td>$1557.81</td>
</tr>
<tr>
<th>Avg. winning trade</th>
<td>$9568.25</td>
<td>$9568.25</td>
</tr>
<tr>
<th>Avg. losing trade</th>
<td>$-4486.44</td>
<td>$-4486.44</td>
</tr>
<tr>
<th>Ratio Avg. Win:Avg. Loss</th>
<td>$2.13</td>
<td>$2.13</td>
</tr>
<tr>
<th>Largest winning trade</th>
<td>$78260.00</td>
<td>$78260.00</td>
</tr>
<tr>
<th>Largest losing trade</th>
<td>$-14152.00</td>
<td>$-14152.00</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Duration stats</th>
<th>All trades</th>
<th>Long trades</th>
</tr>
</thead>
<tbody>
<tr>
<th>Avg duration</th>
<td>73 days 05:28:17.414507</td>
<td>73 days 05:28:17.414507</td>
</tr>
<tr>
<th>Median duration</th>
<td>58 days 00:00:00</td>
<td>58 days 00:00:00</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Return stats</th>
<th>All trades</th>
<th>Long trades</th>
</tr>
</thead>
<tbody>
<tr>
<th>Avg returns all round_trips</th>
<td>0.32%</td>
<td>0.32%</td>
</tr>
<tr>
<th>Avg returns winning</th>
<td>2.40%</td>
<td>2.40%</td>
</tr>
<tr>
<th>Avg returns losing</th>
<td>-1.25%</td>
<td>-1.25%</td>
</tr>
<tr>
<th>Median returns all round_trips</th>
<td>-0.17%</td>
<td>-0.17%</td>
</tr>
<tr>
<th>Median returns winning</th>
<td>1.32%</td>
<td>1.32%</td>
</tr>
<tr>
<th>Median returns losing</th>
<td>-1.03%</td>
<td>-1.03%</td>
</tr>
<tr>
<th>Largest winning trade</th>
<td>18.29%</td>
<td>18.29%</td>
</tr>
<tr>
<th>Largest losing trade</th>
<td>-5.57%</td>
<td>-5.57%</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Symbol stats</th>
<th>AAPL</th>
<th>AMZN</th>
<th>GOOG</th>
<th>HPQ</th>
<th>IBM</th>
<th>MSFT</th>
<th>NVDA</th>
<th>QCOM</th>
<th>SNY</th>
<th>VZ</th>
<th>YHOO</th>
</tr>
</thead>
<tbody>
<tr>
<th>Avg returns all round_trips</th>
<td>0.88%</td>
<td>0.30%</td>
<td>0.37%</td>
<td>0.67%</td>
<td>-0.13%</td>
<td>-0.10%</td>
<td>1.53%</td>
<td>-0.02%</td>
<td>-0.50%</td>
<td>0.16%</td>
<td>0.68%</td>
</tr>
<tr>
<th>Avg returns winning</th>
<td>2.33%</td>
<td>1.92%</td>
<td>1.92%</td>
<td>4.39%</td>
<td>0.84%</td>
<td>1.73%</td>
<td>5.75%</td>
<td>2.02%</td>
<td>0.85%</td>
<td>2.24%</td>
<td>3.69%</td>
</tr>
<tr>
<th>Avg returns losing</th>
<td>-0.99%</td>
<td>-2.40%</td>
<td>-0.56%</td>
<td>-1.98%</td>
<td>-0.57%</td>
<td>-1.26%</td>
<td>-1.43%</td>
<td>-1.65%</td>
<td>-2.00%</td>
<td>-1.12%</td>
<td>-0.82%</td>
</tr>
<tr>
<th>Median returns all round_trips</th>
<td>0.26%</td>
<td>0.43%</td>
<td>-0.16%</td>
<td>-0.73%</td>
<td>-0.12%</td>
<td>-0.55%</td>
<td>-0.40%</td>
<td>-0.28%</td>
<td>0.09%</td>
<td>-0.59%</td>
<td>-0.30%</td>
</tr>
<tr>
<th>Median returns winning</th>
<td>1.70%</td>
<td>1.46%</td>
<td>1.65%</td>
<td>0.31%</td>
<td>0.48%</td>
<td>1.26%</td>
<td>1.64%</td>
<td>1.57%</td>
<td>0.57%</td>
<td>1.38%</td>
<td>3.40%</td>
</tr>
<tr>
<th>Median returns losing</th>
<td>-0.83%</td>
<td>-2.25%</td>
<td>-0.36%</td>
<td>-1.68%</td>
<td>-0.34%</td>
<td>-1.35%</td>
<td>-1.22%</td>
<td>-1.14%</td>
<td>-1.61%</td>
<td>-0.97%</td>
<td>-0.99%</td>
</tr>
<tr>
<th>Largest winning trade</th>
<td>6.91%</td>
<td>6.55%</td>
<td>4.25%</td>
<td>13.84%</td>
<td>2.83%</td>
<td>3.46%</td>
<td>18.29%</td>
<td>5.06%</td>
<td>2.10%</td>
<td>7.23%</td>
<td>8.62%</td>
</tr>
<tr>
<th>Largest losing trade</th>
<td>-1.94%</td>
<td>-4.46%</td>
<td>-1.33%</td>
<td>-3.85%</td>
<td>-1.72%</td>
<td>-3.12%</td>
<td>-2.83%</td>
<td>-4.83%</td>
<td>-5.57%</td>
<td>-2.09%</td>
<td>-1.44%</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Profitability (PnL / PnL total) per name</th>
<th>pnl</th>
</tr>
</thead>
<tbody>
<tr>
<th>NVDA</th>
<td>0.41%</td>
</tr>
<tr>
<th>YHOO</th>
<td>0.27%</td>
</tr>
<tr>
<th>AAPL</th>
<td>0.20%</td>
</tr>
<tr>
<th>AMZN</th>
<td>0.16%</td>
</tr>
<tr>
<th>HPQ</th>
<td>0.08%</td>
</tr>
<tr>
<th>GOOG</th>
<td>0.04%</td>
</tr>
<tr>
<th>QCOM</th>
<td>0.01%</td>
</tr>
<tr>
<th>MSFT</th>
<td>-0.00%</td>
</tr>
<tr>
<th>IBM</th>
<td>-0.03%</td>
</tr>
<tr>
<th>VZ</th>
<td>-0.04%</td>
</tr>
<tr>
<th>SNY</th>
<td>-0.10%</td>
</tr>
</tbody>
</table>
</div>
<p><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/output_19_7.png" alt="png" width="632" height="816" srcset="https://ntguardian.files.wordpress.com/2017/06/output_19_7.png?w=632&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/output_19_7.png?w=680" scale="2"></p>
<p>Above I found the round-trip statistics for my strategy during the backtest (that is, how trades tended to perform). We can see how many trades were conducted, how long the strategy tended to be in the market, how profitable trades tended to be, extreme statistic (largest winning trade, largest losing trade, max duration of a trade, etc.), how profitable certain symbols were, and many other useful metrics, along with graphics. This is much more digestable than the <strong>backtrader</strong> <code>Analyzer</code>s default outputs.</p>
<p>Unfortunately, with Yahoo! Finance’s recent changes breaking <strong>pandas-datareader</strong>, <strong>PyFolio</strong> is not very stable right now and won’t be until <strong>pandas-datareader</strong> is updated. This is unfortunate, and reveals a flaw in <strong>PyFolio</strong>‘s design; using alternative data sources (both online and offline) for the data provided in their tear sheet functions should be better supported. While I was able to get the code below to work, this require some hacks and rolling back of packages. I cannot guarantee the code will work for you at this time. Additionally, some of the graphics <strong>PyFolio</strong> wants to create (such as comparing the performance of the strategy to SPY) don’t work since <strong>PyFolio</strong> can’t fetch the data.</p>
<p>Anyway, what does <strong>PyFolio</strong> include in its “full” tear sheet? We have some of the usual performance metrics, along with some more exotic ones, such as:</p>
<ul>
<li>The <a href="http://www.investopedia.com/terms/c/calmarratio.asp">Calmar ratio</a>, a risk-adjusted performance metric comparing compound rate of returns to the maximum drawdown.</li>
<li>The <a href="https://en.wikipedia.org/wiki/Omega_ratio">Omega ratio</a>, a newer and more exotic performance metric that effectively compares the gains of an investment to its losses, relative to some target.</li>
<li><a href="https://en.wikipedia.org/wiki/Skewness">Skew</a>, which describes the shape of the distribution of returns; a positive skew indicates a longer tail for gains (that is, more “extreme” values for gains), a negative value a longer tail for losses, and a skew of 0 indicates a symmetric distribution of returns around their mean.<br>
<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/skewness.png" alt="Skewness Wikipedia illustration" width="446" height="159" srcset="https://ntguardian.files.wordpress.com/2017/06/skewness.png?w=446&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/skewness.png?w=680" scale="2"><br>
<em>An illustration of positive and negative skewness provided by <a href="https://en.wikipedia.org/wiki/Skewness">Wikipedia</a>.</em></li>
<li><a href="https://en.wikipedia.org/wiki/Kurtosis">Kurtosis</a>, another descriptor of the shape of the distribution of returns; a kurtosis larger than 3 indicates that the distribution is more “spread out” than the <a href="https://en.wikipedia.org/wiki/Normal_distributiibutedon">Normal distribution</a> and indicates that extreme values in returns are more common, while a kurtosis smaller than 3 indicates that returns are more concentrated than if they were Normally distributed. Sometimes people describe “excess kurtosis”, where the Normal distribution has an excess kurtosis of zero and other distributions have an excess kurtosis above or below zero (so take kurtosis and subtract 3).<br>
<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/640px-standard_symmetric_pdfs.png" alt="Kurtosis Wikipedia illustration" width="552" height="394" srcset="https://ntguardian.files.wordpress.com/2017/06/640px-standard_symmetric_pdfs.png?w=552&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/640px-standard_symmetric_pdfs.png?w=680" scale="2"><br>
<em>Visualization of distributions with different kurtosis, provided by <a href="https://en.wikipedia.org/wiki/Kurtosis">Wikipedia</a>. Notice that the legend displays excess kurtosis, or kurtosis minus three. All of these distributions have mean zero and variance one, yet still can be more or less spread out around the center than the Normal distribution.</em></li>
<li>Tail ratio, which is the ratio between the 95th percentile of returns and the absolute value of the 5th percentile of returns (so a tail ratio of 0.5 would imply that losses were twice as bad as winnings); the larger this number is, the better extreme winnings are compared to extreme losses.</li>
<li>If the profit ratio is total profits divided by total losses, then the common sense ratio is the profit ratio multiplied with the tail ratio.</li>
<li><a href="http://www.investopedia.com/terms/i/informationratio.asp">Information ratio</a>, which is the excess return of the strategy relative to a benchmark index divided by the standard deviation of the difference in returns between the strategy and the benchmark. (Here, since I had to use a constant benchmark return representing the risk-free rate, this number is not working as it should; again, you can send your gratitude to Verizon and tell them you approve of what they’ve done with Yahoo! Finance.)</li>
<li><a href="https://en.wikipedia.org/wiki/Alpha_(finance)">Alpha</a>, which is performance relative to risk or some benchmark. Positive alpha is good, negative alpha is bad. (Again, not working right now.)</li>
<li><a href="https://en.wikipedia.org/wiki/Beta_(finance)">Beta</a>, the volatility of an asset relative to its benchmark. A beta less than one is good (less volatile than the market), while a beta greater than one is bad (more volatile than the market). (Not currently working.)</li>
<li><a href="http://www.investopedia.com/terms/t/turnover.asp">Turnover</a>, or how much of the account is sold in trades; a high turnover rate means higher commissions.</li>
<li>Reaction to stress events, such as the <a href="https://en.wikipedia.org/wiki/Fukushima_Daiichi_nuclear_disaster">Fukushima disaster</a>, the <a href="https://en.wikipedia.org/wiki/2010_Flash_Crash">2010 Flash Crash</a>, and others.</li>
</ul>
<p>For some reason, <code>create_full_tear_sheet()</code> does not seem to be aware of other symbols being traded than Nvidia (NVDA). I have no idea why.</p>
<p>I create the full tear sheet below.</p>
<div><div id="highlighter_488702" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python functions">len</code><code class="python plain">(returns.index)</code></div></div></td></tr></tbody></table></div></div>
<pre><code>1720
</code></pre>
<div><div id="highlighter_917621" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">benchmark_rets </code><code class="python keyword">=</code> <code class="python plain">pd.Series([</code><code class="python value">0.00004</code><code class="python plain">] </code><code class="python keyword">*</code> <code class="python functions">len</code><code class="python plain">(returns.index), index</code><code class="python keyword">=</code><code class="python plain">returns.index)&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Risk-free rate, we need to</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># set this ourselves otherwise</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># PyFolio will try to fetch from</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># Yahoo! Finance which is now garbage</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python comments"># NOTE: Thanks to Yahoo! Finance giving the finger to their users (thanks Verizon, we love you too),</code></div><div class="line number7 index6 alt2"><code class="python comments"># PyFolio is unstable and will be until updates are made to pandas-datareader, so there may be issues</code></div><div class="line number8 index7 alt1"><code class="python comments"># using it</code></div><div class="line number9 index8 alt2"><code class="python plain">pf.create_full_tear_sheet(returns, positions, transactions, benchmark_rets</code><code class="python keyword">=</code><code class="python plain">benchmark_rets)</code></div></div></td></tr></tbody></table></div></div>
<pre><code>Entire data start date: 2010-01-04
Entire data end date: 2016-10-31


Backtest Months: 81
</code></pre>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Performance statistics</th>
<th>Backtest</th>
</tr>
</thead>
<tbody>
<tr>
<th>annual_return</th>
<td>-0.04</td>
</tr>
<tr>
<th>cum_returns_final</th>
<td>-0.26</td>
</tr>
<tr>
<th>annual_volatility</th>
<td>0.11</td>
</tr>
<tr>
<th>sharpe_ratio</th>
<td>-0.34</td>
</tr>
<tr>
<th>calmar_ratio</th>
<td>-0.11</td>
</tr>
<tr>
<th>stability_of_timeseries</th>
<td>0.72</td>
</tr>
<tr>
<th>max_drawdown</th>
<td>-0.41</td>
</tr>
<tr>
<th>omega_ratio</th>
<td>0.94</td>
</tr>
<tr>
<th>sortino_ratio</th>
<td>-0.46</td>
</tr>
<tr>
<th>skew</th>
<td>-0.27</td>
</tr>
<tr>
<th>kurtosis</th>
<td>3.14</td>
</tr>
<tr>
<th>tail_ratio</th>
<td>0.95</td>
</tr>
<tr>
<th>common_sense_ratio</th>
<td>0.90</td>
</tr>
<tr>
<th>gross_leverage</th>
<td>0.20</td>
</tr>
<tr>
<th>information_ratio</th>
<td>-0.03</td>
</tr>
<tr>
<th>alpha</th>
<td>nan</td>
</tr>
<tr>
<th>beta</th>
<td>nan</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Worst drawdown periods</th>
<th>net drawdown in %</th>
<th>peak date</th>
<th>valley date</th>
<th>recovery date</th>
<th>duration</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>41.30</td>
<td>2011-02-17</td>
<td>2016-01-20</td>
<td>NaT</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>17.11</td>
<td>2010-04-15</td>
<td>2010-08-30</td>
<td>2011-01-06</td>
<td>191</td>
</tr>
<tr>
<th>2</th>
<td>2.77</td>
<td>2011-01-14</td>
<td>2011-01-21</td>
<td>2011-01-27</td>
<td>10</td>
</tr>
<tr>
<th>3</th>
<td>2.74</td>
<td>2011-01-27</td>
<td>2011-01-28</td>
<td>2011-02-04</td>
<td>7</td>
</tr>
<tr>
<th>4</th>
<td>1.39</td>
<td>2011-02-04</td>
<td>2011-02-10</td>
<td>2011-02-17</td>
<td>10</td>
</tr>
</tbody>
</table>
</div>
<pre><code>[-0.014 -0.032]
</code></pre>
<p><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/output_22_4.png" alt="png" width="632" height="2502" srcset="https://ntguardian.files.wordpress.com/2017/06/output_22_4.png?w=632&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/output_22_4.png?w=680" scale="2"></p>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Stress Events</th>
<th>mean</th>
<th>min</th>
<th>max</th>
</tr>
</thead>
<tbody>
<tr>
<th>US downgrade/European Debt Crisis</th>
<td>-0.25%</td>
<td>-3.53%</td>
<td>2.24%</td>
</tr>
<tr>
<th>Fukushima</th>
<td>-0.05%</td>
<td>-1.83%</td>
<td>1.15%</td>
</tr>
<tr>
<th>EZB IR Event</th>
<td>-0.08%</td>
<td>-1.52%</td>
<td>1.22%</td>
</tr>
<tr>
<th>Flash Crash</th>
<td>-0.19%</td>
<td>-1.16%</td>
<td>1.28%</td>
</tr>
<tr>
<th>Apr14</th>
<td>0.02%</td>
<td>-1.39%</td>
<td>1.49%</td>
</tr>
<tr>
<th>Oct14</th>
<td>-0.13%</td>
<td>-1.40%</td>
<td>0.81%</td>
</tr>
<tr>
<th>Fall2015</th>
<td>-0.08%</td>
<td>-1.85%</td>
<td>2.62%</td>
</tr>
<tr>
<th>Recovery</th>
<td>-0.03%</td>
<td>-3.78%</td>
<td>2.91%</td>
</tr>
<tr>
<th>New Normal</th>
<td>-0.00%</td>
<td>-3.23%</td>
<td>2.62%</td>
</tr>
</tbody>
</table>
</div>
<p><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/output_22_6.png" alt="png" width="632" height="1115" srcset="https://ntguardian.files.wordpress.com/2017/06/output_22_6.png?w=632&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/output_22_6.png?w=680" scale="2"></p>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Top 10 long positions of all time</th>
<th>max</th>
</tr>
</thead>
<tbody>
<tr>
<th>NVDA</th>
<td>86.99%</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Top 10 short positions of all time</th>
<th>max</th>
</tr>
</thead>
<tbody>
  </tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>Top 10 positions of all time</th>
<th>max</th>
</tr>
</thead>
<tbody>
<tr>
<th>NVDA</th>
<td>86.99%</td>
</tr>
</tbody>
</table>
</div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th>All positions ever held</th>
<th>max</th>
</tr>
</thead>
<tbody>
<tr>
<th>NVDA</th>
<td>86.99%</td>
</tr>
</tbody>
</table>
</div>
<p><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/output_22_11.png" alt="png" width="632" height="1375" srcset="https://ntguardian.files.wordpress.com/2017/06/output_22_11.png?w=632&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/output_22_11.png?w=680" scale="2"></p>
<p><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/output_22_13.png" alt="png" width="632" height="881" srcset="https://ntguardian.files.wordpress.com/2017/06/output_22_13.png?w=632&amp;zoom=2 2x" src-orig="https://ntguardian.files.wordpress.com/2017/06/output_22_13.png?w=680" scale="2"></p>
<h2>Optimizing with Different Metrics</h2>
<p>Instead of optimizing with respect to returns, we may want to optimize with respect to a risk-adjusted metric, such as the Sharpe ratio. We can investigate the results of using different metrics for optimization with walk-forward analysis.</p>
<p>In walk-forward analysis we might add an additional metric to our arsenal, the walk-forward efficiency ratio (WFER). This ratio gives a sens of our system’s out-of-sample performance. If we were optimizing with respect to returns, we’d divide out-of-sample returns by the returns obtained by the optimized strategy. If this is greater than 1, our out-of-sample returns were higher than optimized returns, while if this is less than 1, out-of-sample returns are less than optimized returns. This can be applied to any metric we use for optimization, and gives a sense for how much our strategy tends to overfit. A low WFER suggests a high propensity to overfit. (Unfortunately, my code for WFER doesn’t seem to be correct right now.)</p>
<p>Below I create a function to automate the walk-forward analysis process. You pass the function a Cerebro object with everything added to it except the strategy and the data; these are passed as arguments to the function and will be handled by it. (You can only work with one strategy at a time.) All analyzers are combined together into one dictionary at the end of one iteration, and all of these dictionaries are returned in a list. If the dictionaries are all flat, this list can easily be converted to a <strong>pandas</strong> <code>DataFrame</code>.</p>
<div><div id="highlighter_910634" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">wfa(cerebro, strategy, opt_param, split, datafeeds, analyzer_max, var_maximize,</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">opt_p_vals, opt_p_vals_args</code><code class="python keyword">=</code><code class="python plain">{}, params</code><code class="python keyword">=</code><code class="python plain">{}, minimize</code><code class="python keyword">=</code><code class="python color1">False</code><code class="python plain">):</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Perform a walk-forward analysis</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">args:</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">cerebro: A Cerebro object, with everything added except the strategy and data feeds; that is, all</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">analyzers, sizers, starting balance, etc. needed have been added</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">strategy: A Strategy object for optimizing</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">params: A dict that contains all parameters to be set for the Strategy except the parameter to be</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">optimized</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">split: Defines the splitting of the data into training and test sets, perhaps created by</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">TimeSeriesSplit.split()</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">datafeeds: A dict containing pandas DataFrames that are the data feeds to be added to Cerebro</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">objects and used by the strategy; keys are the names of the strategies</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">analyzer_max: A string denoting the name of the analyzer with the statistic to maximize</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">var_maximize: A string denoting the variable to maximize (perhaps the key of a dict)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">opt_param: A string: the parameter of the strategy being optimized</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">opt_p_vals: This can be either a list or function; if a function, it must return a list, and the</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">list will contain possible values that opt_param will take in optimization; if a list, it already</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">contains these values</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">opt_p_vals_args: A dict of parameters to pass to opt_p_vals; ignored if opt_p_vals is not a function</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">minimize: A boolean that if True will minimize the parameter rather than maximize</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">return:</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">A list of dicts that contain data for the walk-forward analysis, including the relevant</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">analyzer's data, the value of the optimized statistic on the training set, start and end dates for</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">the test set, and the walk forward efficiency ratio (WFER)</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">usr_opt_p_vals </code><code class="python keyword">=</code> <code class="python plain">opt_p_vals</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">walk_forward_results </code><code class="python keyword">=</code> <code class="python functions">list</code><code class="python plain">()</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">train, test </code><code class="python keyword">in</code> <code class="python plain">split:</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">trainer, tester </code><code class="python keyword">=</code> <code class="python plain">deepcopy(cerebro), deepcopy(cerebro)</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python functions">callable</code><code class="python plain">(usr_opt_p_vals):</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">opt_p_vals </code><code class="python keyword">=</code> <code class="python plain">usr_opt_p_vals(</code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">opt_p_vals_args)</code></div><div class="line number37 index36 alt2">&nbsp;</div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># TRAINING</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">trainer.optstrategy(strategy, </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">params, </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">{opt_param: opt_p_vals})</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">s, df </code><code class="python keyword">in</code> <code class="python plain">datafeeds.items():</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">bt.feeds.PandasData(dataname</code><code class="python keyword">=</code><code class="python plain">df.iloc[train], name</code><code class="python keyword">=</code><code class="python plain">s)</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">trainer.adddata(data)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python plain">trainer.run()</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_df </code><code class="python keyword">=</code> <code class="python plain">DataFrame({</code><code class="python functions">getattr</code><code class="python plain">(r[</code><code class="python value">0</code><code class="python plain">].params, opt_param): </code><code class="python functions">dict</code><code class="python plain">(</code><code class="python functions">getattr</code><code class="python plain">(r[</code><code class="python value">0</code><code class="python plain">].analyzers,</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">analyzer_max).get_analysis()) </code><code class="python keyword">for</code> <code class="python plain">r </code><code class="python keyword">in</code> <code class="python plain">res}</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">).T.loc[:, var_maximize].sort_values(ascending</code><code class="python keyword">=</code><code class="python plain">minimize)</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">opt_res, opt_val </code><code class="python keyword">=</code> <code class="python plain">res_df.index[</code><code class="python value">0</code><code class="python plain">], res_df[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># TESTING</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tester.addstrategy(strategy, </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">params, </code><code class="python keyword">*</code><code class="python keyword">*</code><code class="python plain">{opt_param: opt_res})</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">s, df </code><code class="python keyword">in</code> <code class="python plain">datafeeds.items():</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">bt.feeds.PandasData(dataname</code><code class="python keyword">=</code><code class="python plain">df.iloc[test], name</code><code class="python keyword">=</code><code class="python plain">s)</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tester.adddata(data)</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python plain">tester.run()</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict </code><code class="python keyword">=</code> <code class="python functions">dict</code><code class="python plain">(</code><code class="python functions">getattr</code><code class="python plain">(res[</code><code class="python value">0</code><code class="python plain">].analyzers, analyzer_max).get_analysis())</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict[</code><code class="python string">"train_"</code> <code class="python keyword">+</code> <code class="python plain">var_maximize] </code><code class="python keyword">=</code> <code class="python plain">opt_val</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict[opt_param] </code><code class="python keyword">=</code> <code class="python plain">opt_res</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s0 </code><code class="python keyword">=</code> <code class="python plain">[</code><code class="python keyword">*</code><code class="python plain">datafeeds.keys()][</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict[</code><code class="python string">"start_date"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">datafeeds[s0].iloc[test[</code><code class="python value">0</code><code class="python plain">]].name</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict[</code><code class="python string">"end_date"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">datafeeds[s0].iloc[test[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">]].name</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">test_val </code><code class="python keyword">=</code> <code class="python functions">getattr</code><code class="python plain">(res[</code><code class="python value">0</code><code class="python plain">].analyzers, analyzer_max).get_analysis()[var_maximize]</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict[</code><code class="python string">"WFER"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">test_val </code><code class="python keyword">/</code> <code class="python plain">opt_val</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code><code class="python plain">:</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict[</code><code class="python string">"WFER"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python plain">np.nan</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">anlz </code><code class="python keyword">in</code> <code class="python plain">res[</code><code class="python value">0</code><code class="python plain">].analyzers:</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res_dict.update(</code><code class="python functions">dict</code><code class="python plain">(anlz.get_analysis()))</code></div><div class="line number68 index67 alt1">&nbsp;</div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">walk_forward_results.append(res_dict)</code></div><div class="line number70 index69 alt1">&nbsp;</div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">walk_forward_results</code></div></div></td></tr></tbody></table></div></div>
<p>The function can be given a list of possible choices of parameters to optimize over, but can also accept a function that generates this list (perhaps you are choosing possible parameter values randomly). I create a generator function below, that will be used in the walk-forward analysis.</p>
<div><div id="highlighter_801503" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">random_fs_list():</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Generate random combinations of fast and slow window lengths to test"""</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">windowset </code><code class="python keyword">=</code> <code class="python functions">set</code><code class="python plain">()&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Use a set to avoid duplicates</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python functions">len</code><code class="python plain">(windowset) &lt; </code><code class="python value">40</code><code class="python plain">:</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">f </code><code class="python keyword">=</code> <code class="python plain">random.randint(</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">10</code><code class="python plain">) </code><code class="python keyword">*</code> <code class="python value">5</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">random.randint(</code><code class="python value">1</code><code class="python plain">, </code><code class="python value">10</code><code class="python plain">) </code><code class="python keyword">*</code> <code class="python value">10</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">f &gt; s:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Cannot have the fast moving average have a longer window than the slow, so swap</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">f, s </code><code class="python keyword">=</code> <code class="python plain">s, f</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">f </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">s:&nbsp;&nbsp;&nbsp; </code><code class="python comments"># Cannot be equal, so do nothing, discarding results</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">continue</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">windowset.add((f, s))</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python functions">list</code><code class="python plain">(windowset)</code></div></div></td></tr></tbody></table></div></div>
<p>Now let’s get the walk-forward analysis results when optimizing with respect to the Sharpe ratio.</p>
<div><div id="highlighter_9333" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">walkorebro </code><code class="python keyword">=</code> <code class="python plain">bt.Cerebro(stdstats</code><code class="python keyword">=</code><code class="python color1">False</code><code class="python plain">, maxcpus</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python plain">walkorebro.broker.setcash(</code><code class="python value">1000000</code><code class="python plain">)</code></div><div class="line number4 index3 alt1"><code class="python plain">walkorebro.broker.setcommission(</code><code class="python value">0.02</code><code class="python plain">)</code></div><div class="line number5 index4 alt2"><code class="python plain">walkorebro.addanalyzer(btanal.SharpeRatio_A)</code></div><div class="line number6 index5 alt1"><code class="python plain">walkorebro.addanalyzer(btanal.Returns)</code></div><div class="line number7 index6 alt2"><code class="python plain">walkorebro.addanalyzer(AcctStats)</code></div><div class="line number8 index7 alt1"><code class="python plain">walkorebro.addsizer(PropSizer)</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python plain">tscv </code><code class="python keyword">=</code> <code class="python plain">TimeSeriesSplitImproved(</code><code class="python value">10</code><code class="python plain">)</code></div><div class="line number11 index10 alt2"><code class="python plain">split </code><code class="python keyword">=</code> <code class="python plain">tscv.split(datafeeds[</code><code class="python string">"AAPL"</code><code class="python plain">], fixed_length</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">, train_splits</code><code class="python keyword">=</code><code class="python value">2</code><code class="python plain">)</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_759670" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">%</code><code class="python plain">time wfa_sharpe_res </code><code class="python keyword">=</code> <code class="python plain">wfa(walkorebro, SMAC, opt_param</code><code class="python keyword">=</code><code class="python string">"optim_fs"</code><code class="python plain">, params</code><code class="python keyword">=</code><code class="python plain">{</code><code class="python string">"optim"</code><code class="python plain">: </code><code class="python color1">True</code><code class="python plain">}, \</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">split</code><code class="python keyword">=</code><code class="python plain">split, datafeeds</code><code class="python keyword">=</code><code class="python plain">datafeeds, analyzer_max</code><code class="python keyword">=</code><code class="python string">"sharperatio_a"</code><code class="python plain">, \</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">var_maximize</code><code class="python keyword">=</code><code class="python string">"sharperatio"</code><code class="python plain">, opt_p_vals</code><code class="python keyword">=</code><code class="python plain">random_fs_list)</code></div></div></td></tr></tbody></table></div></div>
<pre><code>CPU times: user 2h 7min 13s, sys: 2.55 s, total: 2h 7min 15s
Wall time: 2h 8min 1s
</code></pre>
<div><div id="highlighter_485037" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">DataFrame(wfa_sharpe_res)</code></div></div></td></tr></tbody></table></div></div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th></th>
<th>WFER</th>
<th>end</th>
<th>end_date</th>
<th>growth</th>
<th>optim_fs</th>
<th>ravg</th>
<th>return</th>
<th>rnorm</th>
<th>rnorm100</th>
<th>rtot</th>
<th>sharperatio</th>
<th>start</th>
<th>start_date</th>
<th>train_sharperatio</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>NaN</td>
<td>953091.50</td>
<td>2011-11-14</td>
<td>-46908.50</td>
<td>(45, 70)</td>
<td>-0.000306</td>
<td>0.953091</td>
<td>-0.074217</td>
<td>-7.421736</td>
<td>-0.048044</td>
<td>NaN</td>
<td>1000000</td>
<td>2011-04-05</td>
<td>3.377805</td>
</tr>
<tr>
<th>1</th>
<td>1.274973</td>
<td>892315.80</td>
<td>2012-06-28</td>
<td>-107684.20</td>
<td>(10, 30)</td>
<td>-0.000726</td>
<td>0.892316</td>
<td>-0.167129</td>
<td>-16.712927</td>
<td>-0.113935</td>
<td>-1.237580</td>
<td>1000000</td>
<td>2011-11-15</td>
<td>-0.970672</td>
</tr>
<tr>
<th>2</th>
<td>1.195509</td>
<td>1007443.84</td>
<td>2013-02-13</td>
<td>7443.84</td>
<td>(15, 90)</td>
<td>0.000047</td>
<td>1.007444</td>
<td>0.011975</td>
<td>1.197496</td>
<td>0.007416</td>
<td>-0.527568</td>
<td>1000000</td>
<td>2012-06-29</td>
<td>-0.441292</td>
</tr>
<tr>
<th>3</th>
<td>NaN</td>
<td>1008344.50</td>
<td>2013-09-26</td>
<td>8344.50</td>
<td>(15, 70)</td>
<td>0.000053</td>
<td>1.008345</td>
<td>0.013427</td>
<td>1.342750</td>
<td>0.008310</td>
<td>NaN</td>
<td>1000000</td>
<td>2013-02-14</td>
<td>0.480783</td>
</tr>
<tr>
<th>4</th>
<td>-3.030306</td>
<td>991597.32</td>
<td>2014-05-12</td>
<td>-8402.68</td>
<td>(40, 70)</td>
<td>-0.000054</td>
<td>0.991597</td>
<td>-0.013453</td>
<td>-1.345278</td>
<td>-0.008438</td>
<td>-3.380193</td>
<td>1000000</td>
<td>2013-09-27</td>
<td>1.115463</td>
</tr>
<tr>
<th>5</th>
<td>NaN</td>
<td>960946.16</td>
<td>2014-12-22</td>
<td>-39053.84</td>
<td>(20, 70)</td>
<td>-0.000254</td>
<td>0.960946</td>
<td>-0.061941</td>
<td>-6.194062</td>
<td>-0.039837</td>
<td>NaN</td>
<td>1000000</td>
<td>2014-05-13</td>
<td>0.636099</td>
</tr>
<tr>
<th>6</th>
<td>-4.286899</td>
<td>966705.62</td>
<td>2015-08-06</td>
<td>-33294.38</td>
<td>(20, 80)</td>
<td>-0.000216</td>
<td>0.966706</td>
<td>-0.052900</td>
<td>-5.289996</td>
<td>-0.033861</td>
<td>-1.600702</td>
<td>1000000</td>
<td>2014-12-23</td>
<td>0.373394</td>
</tr>
<tr>
<th>7</th>
<td>0.293385</td>
<td>1011624.06</td>
<td>2016-03-21</td>
<td>11624.06</td>
<td>(25, 90)</td>
<td>0.000074</td>
<td>1.011624</td>
<td>0.018723</td>
<td>1.872324</td>
<td>0.011557</td>
<td>-0.623374</td>
<td>1000000</td>
<td>2015-08-07</td>
<td>-2.124761</td>
</tr>
<tr>
<th>8</th>
<td>NaN</td>
<td>994889.98</td>
<td>2016-10-31</td>
<td>-5110.02</td>
<td>(40, 100)</td>
<td>-0.000033</td>
<td>0.994890</td>
<td>-0.008189</td>
<td>-0.818938</td>
<td>-0.005123</td>
<td>NaN</td>
<td>1000000</td>
<td>2016-03-22</td>
<td>-0.462381</td>
</tr>
</tbody>
</table>
</div>
<p>Returns are arguable better here than when I optimized with respect to just returns since a catastrophically bad strategy was avoided, but I’m not convinced we’re doing any better.</p>
<p>Let’s try with the Sortino ratio now. I have a few reasons for favoring the Sortino ratio as a risk measure:</p>
<ol>
<li>The Sortino ratio uses the standard deviation of losses, which we might call “bad risk”.</li>
<li>Measures reliant on “standard deviaton” implicitly assume Normally distributed returns or that returns are well-behaved in some sense, but if returns follow, say, a <a href="https://en.wikipedia.org/wiki/Power_law">power law</a>, where “extreme events are common”, the standard deviation is not a good measure for risk. Theoretically, the standard deviation may not be well-defined. Since losses are truncated, though (meaning that there is a maximum loss that can be attained), standard deviation for losses should exist theoretically, so we can avoid some these issues. Furthermore, extreme events should make this standard deviation larger rather than smaller (since standard deviation is sensitive to outliers), which makes the overall ratio smaller and thus more conservative in the presence of outlier losses.</li>
</ol>
<p>Let’s see the results when using the Sortino ratio in place of the Sharpe ratio.</p>
<div><div id="highlighter_19965" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">walkorebro.addanalyzer(SortinoRatio)</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python plain">split </code><code class="python keyword">=</code> <code class="python plain">tscv.split(datafeeds[</code><code class="python string">"AAPL"</code><code class="python plain">], fixed_length</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">, train_splits</code><code class="python keyword">=</code><code class="python value">2</code><code class="python plain">)</code></div></div></td></tr></tbody></table></div></div>
<div><div id="highlighter_972201" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">%</code><code class="python plain">time wfa_sortino_res </code><code class="python keyword">=</code> <code class="python plain">wfa(walkorebro, SMAC, opt_param</code><code class="python keyword">=</code><code class="python string">"optim_fs"</code><code class="python plain">, params</code><code class="python keyword">=</code><code class="python plain">{</code><code class="python string">"optim"</code><code class="python plain">: </code><code class="python color1">True</code><code class="python plain">}, \</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">split</code><code class="python keyword">=</code><code class="python plain">split, datafeeds</code><code class="python keyword">=</code><code class="python plain">datafeeds, analyzer_max</code><code class="python keyword">=</code><code class="python string">"sortinoratio"</code><code class="python plain">, \</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">var_maximize</code><code class="python keyword">=</code><code class="python string">"sortinoratio"</code><code class="python plain">, opt_p_vals</code><code class="python keyword">=</code><code class="python plain">random_fs_list)</code></div></div></td></tr></tbody></table></div></div>
<pre><code>/home/curtis/anaconda3/lib/python3.6/site-packages/ipykernel/__main__.py:50: RuntimeWarning: invalid value encountered in log


CPU times: user 2h 7min 33s, sys: 9.39 s, total: 2h 7min 43s
Wall time: 2h 8min 38s
</code></pre>
<div><div id="highlighter_427652" class="syntaxhighlighter collapsed  python"><div class="toolbar"><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_expandSource expandSource">+ expand source</a></span><span><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">DataFrame(wfa_sortino_res)</code></div></div></td></tr></tbody></table></div></div>
<div>
<table border="1" class="dataframe">
<thead>
<tr style="text-align:right;">
<th></th>
<th>WFER</th>
<th>end</th>
<th>end_date</th>
<th>growth</th>
<th>optim_fs</th>
<th>ravg</th>
<th>return</th>
<th>rnorm</th>
<th>rnorm100</th>
<th>rtot</th>
<th>sharperatio</th>
<th>sortinoratio</th>
<th>start</th>
<th>start_date</th>
<th>train_sortinoratio</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-0.285042</td>
<td>988750.90</td>
<td>2011-11-14</td>
<td>-11249.10</td>
<td>(45, 90)</td>
<td>-0.000072</td>
<td>0.988751</td>
<td>-0.017994</td>
<td>-1.799434</td>
<td>-0.011313</td>
<td>NaN</td>
<td>-0.033131</td>
<td>1000000</td>
<td>2011-04-05</td>
<td>0.116231</td>
</tr>
<tr>
<th>1</th>
<td>-6.620045</td>
<td>1007201.00</td>
<td>2012-06-28</td>
<td>7201.00</td>
<td>(50, 100)</td>
<td>0.000046</td>
<td>1.007201</td>
<td>0.011583</td>
<td>1.158345</td>
<td>0.007175</td>
<td>-1.777392</td>
<td>0.097353</td>
<td>1000000</td>
<td>2011-11-15</td>
<td>-0.014706</td>
</tr>
<tr>
<th>2</th>
<td>3.543051</td>
<td>1007443.84</td>
<td>2013-02-13</td>
<td>7443.84</td>
<td>(15, 90)</td>
<td>0.000047</td>
<td>1.007444</td>
<td>0.011975</td>
<td>1.197496</td>
<td>0.007416</td>
<td>-0.527568</td>
<td>0.038794</td>
<td>1000000</td>
<td>2012-06-29</td>
<td>0.010949</td>
</tr>
<tr>
<th>3</th>
<td>0.861968</td>
<td>1008344.50</td>
<td>2013-09-26</td>
<td>8344.50</td>
<td>(15, 70)</td>
<td>0.000053</td>
<td>1.008345</td>
<td>0.013427</td>
<td>1.342750</td>
<td>0.008310</td>
<td>NaN</td>
<td>0.042481</td>
<td>1000000</td>
<td>2013-02-14</td>
<td>0.049283</td>
</tr>
<tr>
<th>4</th>
<td>-0.051777</td>
<td>998959.50</td>
<td>2014-05-12</td>
<td>-1040.50</td>
<td>(35, 70)</td>
<td>-0.000007</td>
<td>0.998960</td>
<td>-0.001670</td>
<td>-0.166958</td>
<td>-0.001041</td>
<td>-20.221528</td>
<td>-0.006508</td>
<td>1000000</td>
<td>2013-09-27</td>
<td>0.125685</td>
</tr>
<tr>
<th>5</th>
<td>-2.029468</td>
<td>972178.20</td>
<td>2014-12-22</td>
<td>-27821.80</td>
<td>(30, 80)</td>
<td>-0.000180</td>
<td>0.972178</td>
<td>-0.044279</td>
<td>-4.427936</td>
<td>-0.028216</td>
<td>NaN</td>
<td>-0.157309</td>
<td>1000000</td>
<td>2014-05-13</td>
<td>0.077512</td>
</tr>
<tr>
<th>6</th>
<td>-4.718336</td>
<td>976411.72</td>
<td>2015-08-06</td>
<td>-23588.28</td>
<td>(45, 80)</td>
<td>-0.000152</td>
<td>0.976412</td>
<td>-0.037590</td>
<td>-3.759040</td>
<td>-0.023871</td>
<td>-1.847879</td>
<td>-0.130495</td>
<td>1000000</td>
<td>2014-12-23</td>
<td>0.027657</td>
</tr>
<tr>
<th>7</th>
<td>-8.761974</td>
<td>1012292.72</td>
<td>2016-03-21</td>
<td>12292.72</td>
<td>(30, 90)</td>
<td>0.000078</td>
<td>1.012293</td>
<td>0.019804</td>
<td>1.980425</td>
<td>0.012218</td>
<td>-0.441576</td>
<td>0.176737</td>
<td>1000000</td>
<td>2015-08-07</td>
<td>-0.020171</td>
</tr>
<tr>
<th>8</th>
<td>NaN</td>
<td>1000000.00</td>
<td>2016-10-31</td>
<td>0.00</td>
<td>(20, 100)</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>1000000</td>
<td>2016-03-22</td>
<td>-0.017480</td>
</tr>
</tbody>
</table>
</div>
<p>This is better, but far from impressive. These analyses reinforce my opinion that the SMAC strategy does not work for the symbols I’ve considered. I would be better off abandoning this line of investigatioin and looking elsewhere.</p>
<h2>Conclusion, and Thoughts On Blogging</h2>
<p>Up to this point, I have been interested mostly in investigating backtesting technology. I wanted to see which packages would allow me to do what I feel I should be able to do with a backtesting system. If I were to move on from this point, I would be looking at identifying different trading systems, not just “how to optimize”, “how to do a walk-forward analysis”, or “how to get the metrics I want from a backtest.”</p>
<p>Now to drift off-topic.</p>
<p>I’ve enjoyed blogging on these topics, but I’ve run into a problem. See, I’m still a graduate student, hoping to get a PhD. I started this blog as a hobby, but these days I have been investing a lot of time into writing these blog posts, which have been technically challenging for me. I spend days researching, writing, and debugging code. I write new blog posts, investing a lot of time in them. I personally grow a lot. Then I look at my website’s stats, and see that despite all the new content I write, perhaps 90% of all the traffic to this blog goes to <a href="https://ntguardian.wordpress.com/2016/09/19/introduction-stock-market-data-python-1/">three</a> <a href="https://ntguardian.wordpress.com/2017/03/27/introduction-stock-market-data-r-1/">blog</a> <a href="https://ntguardian.wordpress.com/2016/09/26/introduction-stock-market-data-python-2/">posts</a>. Despite the fact that I believe I’ve written content that is more interesting than these posts, that content gets hardly any traffic.</p>
<p>I recently read a <a href="https://www.quora.com/I-enjoy-reading-scientific-papers-and-gaining-knowledge-in-many-areas-different-fields-Would-getting-a-Ph-D-with-the-aim-of-going-into-the-industry-afterwards-be-a-good-decision/answer/Ben-Y-Zhao?srid=hZycf">response to a Quora question, written by Prof. Ben Y. Zhao at the University of Chicago</a> that rattled me. In his answer, Prof. Zhao says:</p>
<blockquote><p>
  I might also add that “gaining knowledge in many areas/fields” is likely to be detrimental to getting a PhD. Enjoying many different fields generally translates into a lack of focus in the context of a PhD program, and you’re likely to spend more time marveling over papers from a wide range of topics rather than focusing and digging deep to produce your own research contributions.
</p></blockquote>
<p>As a person who has a lot of interests, I’m bothered by this comment. A lot.</p>
<p>This blog has lead to some book contracts for me. I have one <a href="https://www.packtpub.com/big-data-and-business-intelligence/unpacking-numpy-and-pandas-video">video course introducing <strong>NumPy</strong> and <strong>pandas</strong></a> coming out in a few days, published by Packt Publishing (I will write a post about it not long after it’s out). This was a massive time commitment on my part, more than I thought it would be (I am always significantly underestimating how much time projects will take). When I initially told one of my former professors at the University of Utah that I had been offered a contract to create some video courses, he became upset, almost yelling at me, criticizing me for not “guarding your time.” (My professor directed me to another member of the deparment who had written books in hope that he would disuade me by telling me what the process was like; instead he recommended that I leverage the book deal I got into other book deals, which is the opposite of what my professor intended.)</p>
<p>I couldn’t resist the allure of being published so I agreed to the deal and signed the contracts, but since then, I’ve begun wishing I listened to my professor’s advice. I have two qualifying exams coming up in August, and I don’t feel like I have done nearly enough to prepare for them, partly due to the book deal, and partly due to the time I spend writing blog posts (and I also read too much). Furthermore, I have committed to three more volumes and I don’t want to break a contract; I agreed to do something and I intend to see it to the end. Meanwhile, other publishers have offered me publishing deals and I’m greatly pained whenever I say “no”; I like creating content like this, I like the idea of having a portfolio of published works providing a source of prestige and passive income (and with my rent having increased by over \$100 in two years when I could barely afford it in the first place, I could really use that extra income right now).</p>
<p>Long story short, time is an even scarcer commodity now than it used to be for me. I’m worried about my academic success if I keep burning time like this. It also doesn’t seem like any of my new content “sticks” (it doesn’t bump up what you might call my “latent” viewership rate).</p>
<p>Thus, I’m planning on this being my last “long-form” article for some time. I’m slightly heartbroken to say this. I would love to write more articles about agent-based modelling (particularly the Santa Fe Artificial Stock Market or developing a model for the evolution of party systems in republics), finance and algorithmic trading, statistical models for voting in legislatures (like DW-NOMINATE), and many others. I have notebooks filled with article ideas. I cannot afford the time, though.</p>
<p>I may post occasionally, perhaps with a few code snippets or to announce my video courses. I won’t try to keep a regular schedule, though, and I won’t be writing specifically for the site (that is, something in my studies prompted the topic).</p>
<p>For those reading this article, I would still love to hear your comments on algorithmic trading and if there are areas you are curious about. I’d likely put those into my notebook of ideas to investigate and perhaps I will look into them. I’ve learned a lot maintaining this website and I hope eventually to return to writing weekly long-form articles on topics I’m interested in again someday. Algorithmic trading still intreagues me and I want to play with it from time to time.</p>
<p>Thank you all for reading. When I started blogging, I was hoping to get maybe 70 views in a week. I never imagined I’d be getting at least 400 every day (usually around 500 or 600, sometimes 1,000 on the day of a new post). This took me a lot farther than I thought I would go, and it’s been a great trip in the meantime.</p>
<hr>
<p>I have created a video course that <a href="http://packtpub.com/">Packt Publishing</a> will be publishing later this month, entitled <a href="https://ntguardian.wordpress.com/video-courses/unpacking-numpy-and-pandas/"><em>Unpacking NumPy and Pandas</em></a>, the first volume in a four-volume set of video courses entitled, <em>Taming Data with Python; Excelling as a Data Analyst</em>. This course covers the basics of setting up a Python environment for data analysis with <a href="http://www.continuum.io/">Anaconda</a>, using Jupyter notebooks, and using <strong>NumPy</strong> and <strong>pandas</strong>. If you are starting out using Python for data analysis or know someone who is, please consider buying my course or at least spreading the word about it. You can <a href="https://www.packtpub.com/big-data-and-business-intelligence/unpacking-numpy-and-pandas-video">buy the course directly</a> or <a href="https://www.packtpub.com/mapt/">purchase a subscription to Mapt</a> and watch it there (when it becomes available).</p>
<p>If you like my blog and would like to support it, spread the word (if not get a copy yourself)! Also, stay tuned for future courses I publish with Packt at the <a href="https://ntguardian.wordpress.com/video-courses/">Video Courses</a> section of my site.</p>
<div id="atatags-370373-5a92e9dbb57cd">
        <script type="text/javascript">
            __ATA.cmd.push(function() {
                __ATA.initVideoSlot('atatags-370373-5a92e9dbb57cd', {
                    sectionId: '370373',
                    format: 'inread'
                });
            });
        </script>
    </div>		<div class="wpcnt">
			<div class="wpa wpmrec" style="display: inline-block !important;">
				<span class="wpa-about">Advertisements</span>
				<div class="u">		<div style="padding-bottom:15px;width:300px;height:250px;float:left;margin-right:5px;margin-top:0px">
		<div id="atatags-26942-5a92e9dbb5838" style="overflow: hidden; position: relative; width: auto; height: auto;"><div style="width: 300px; height: 250px;"><iframe frameborder="0" scrolling="no" width="300" height="250" style="border:none;overflow:hidden;width:300px;height:250px;" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource.html"></iframe></div><div id="atatags-26942-5a92e9dbb5838__controls" style="width:300px;height:10px;text-align:right;line-height:6px;"><span id="atatags-26942-5a92e9dbb5838__complain-btn" style="font-size: 10px; color: rgb(109, 171, 210); text-decoration: underline; cursor: pointer; display: inline;">Report this ad</span></div></div></div>		<div style="padding-bottom:15px;width:300px;height:250px;float:left;margin-top:0px">
		<div id="atatags-114160-5a92e9dbb586e" style="overflow: hidden; position: relative; width: auto; height: auto;"><div style="width: 300px; height: 250px;"><iframe frameborder="0" scrolling="no" width="300" height="250" style="border:none;overflow:hidden;width:300px;height:250px;" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(10).html"></iframe><iframe frameborder="0" scrolling="no" width="300" height="250" style="width:0px;height:0px;border:none;" tabindex="-1" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(11).html"></iframe></div><div id="atatags-114160-5a92e9dbb586e__controls" style="width:300px;height:10px;text-align:right;line-height:6px;"><span id="atatags-114160-5a92e9dbb586e__complain-btn" style="font-size: 10px; color: rgb(109, 171, 210); text-decoration: underline; cursor: pointer; display: inline;">Report this ad</span></div></div></div></div>
						<div id="crt-913830080" style="width: 300px; height: 250px; display: none !important;"></div>
		<script type="text/javascript">
(function(){var c=function(){var a=document.getElementById("crt-913830080");window.Criteo?(a.parentNode.style.setProperty("display","inline-block","important"),a.style.setProperty("display","block","important"),window.Criteo.DisplayAcceptableAdIfAdblocked({zoneid:388248,containerid:"crt-913830080",collapseContainerIfNotAdblocked:!0,callifnotadblocked:function(){a.style.setProperty("display","none","important");a.style.setProperty("visbility","hidden","important")}})):(a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"))};if(window.Criteo)c();else{if(!__ATA.criteo.script){var b=document.createElement("script");b.src="//static.criteo.net/js/ld/publishertag.js";b.onload=function(){for(var a=0;a<__ATA.criteo.cmd.length;a++){var b=__ATA.criteo.cmd[a];"function"===typeof b&&b()}};(document.head||document.getElementsByTagName("head")[0]).appendChild(b);__ATA.criteo.script=b}__ATA.criteo.cmd.push(c)}})();
		</script>		<div id="crt-4572287" style="width: 300px; height: 250px; display: none !important;"></div>
		<script type="text/javascript">
(function(){var c=function(){var a=document.getElementById("crt-4572287");window.Criteo?(a.parentNode.style.setProperty("display","inline-block","important"),a.style.setProperty("display","block","important"),window.Criteo.DisplayAcceptableAdIfAdblocked({zoneid:837497,containerid:"crt-4572287",collapseContainerIfNotAdblocked:!0,callifnotadblocked:function(){a.style.setProperty("display","none","important");a.style.setProperty("visbility","hidden","important")}})):(a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"))};if(window.Criteo)c();else{if(!__ATA.criteo.script){var b=document.createElement("script");b.src="//static.criteo.net/js/ld/publishertag.js";b.onload=function(){for(var a=0;a<__ATA.criteo.cmd.length;a++){var b=__ATA.criteo.cmd[a];"function"===typeof b&&b()}};(document.head||document.getElementsByTagName("head")[0]).appendChild(b);__ATA.criteo.script=b}__ATA.criteo.cmd.push(c)}})();
		</script>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-3081" class="share-twitter sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-3081" class="share-facebook sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=facebook&amp;nb=1" target="_blank" title="Share on Facebook"><span>Facebook<span class="share-count">2</span></span></a></li><li class="share-email share-service-visible"><a rel="nofollow" data-shared="" class="share-email sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=email&amp;nb=1" target="_blank" title="Click to email"><span>Email</span></a></li><li class="share-reddit"><a rel="nofollow" data-shared="" class="share-reddit sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=reddit&amp;nb=1" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="sharing-anchor sd-button share-more"><span>More</span></a></li><li class="share-end"></li></ul><div class="sharing-hidden"><div class="inner" style="display: none;"><ul><li class="share-print"><a rel="nofollow" data-shared="" class="share-print sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#print" target="_blank" title="Click to print"><span>Print</span></a></li><li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-3081" class="share-linkedin sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=linkedin&amp;nb=1" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-end"></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-3081" class="share-google-plus-1 sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-tumblr"><a rel="nofollow" data-shared="" class="share-tumblr sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=tumblr&amp;nb=1" target="_blank" title="Click to share on Tumblr"><span>Tumblr</span></a></li><li class="share-end"></li><li class="share-pinterest"><a rel="nofollow" data-shared="sharing-pinterest-3081" class="share-pinterest sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=pinterest&amp;nb=1" target="_blank" title="Click to share on Pinterest"><span>Pinterest</span></a></li><li class="share-pocket"><a rel="nofollow" data-shared="" class="share-pocket sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=pocket&amp;nb=1" target="_blank" title="Click to share on Pocket"><span>Pocket</span></a></li><li class="share-end"></li><li class="share-telegram"><a rel="nofollow" data-shared="" class="share-telegram sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=telegram&amp;nb=1" target="_blank" title="Click to share on Telegram"><span>Telegram</span></a></li><li class="share-jetpack-whatsapp"><a rel="nofollow" data-shared="" class="share-jetpack-whatsapp sd-button share-icon" href="whatsapp://send?text=Stock%20Trading%20Analytics%20and%20Optimization%20in%20Python%20with%20PyFolio%2C%20R%27s%20PerformanceAnalytics%2C%20and%20backtrader https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F" target="_blank" title="Click to share on WhatsApp"><span>WhatsApp</span></a></li><li class="share-end"></li><li class="share-skype"><a rel="nofollow" data-shared="sharing-skype-3081" class="share-skype sd-button share-icon" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?share=skype&amp;nb=1" target="_blank" title="Click to share on Skype"><span>Skype</span></a></li><li class="share-end"></li></ul></div></div></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-31302869-3081-5a92e9dbc29d5" data-src="//widgets.wp.com/likes/index.html?ver=20180221#blog_id=31302869&amp;post_id=3081&amp;origin=ntguardian.wordpress.com&amp;obj_id=31302869-3081-5a92e9dbc29d5" data-name="like-post-frame-31302869-3081-5a92e9dbc29d5"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-31302869-3081-5a92e9dbc29d5" height="55px" width="100%" frameborder="0" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/index(1).html"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	
<div class="jp-relatedposts-items jp-relatedposts-items-minimal"><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="3002" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://ntguardian.wordpress.com/2017/06/12/getting-started-with-backtrader/" title="Getting Started with backtrader

In this article I give an introductory example for using the Python backtesting platform backtrader." rel="nofollow" data-origin="3081" data-position="0">Getting Started with backtrader</a></span><span class="jp-relatedposts-post-context">In "Economics and Finance"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="2453" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://ntguardian.wordpress.com/2017/03/27/introduction-stock-market-data-r-1/" title="An Introduction to Stock Market Data Analysis with R (Part 1)

This is my first article in a two-part series introducing stock data analysis using R." rel="nofollow" data-origin="3081" data-position="1">An Introduction to Stock Market Data Analysis with R (Part 1)</a></span><span class="jp-relatedposts-post-context">In "Economics and Finance"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="1088" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://ntguardian.wordpress.com/2016/09/19/introduction-stock-market-data-python-1/" title="An Introduction to Stock Market Data Analysis with Python (Part 1)

This post is the first in a two-part series on stock data analysis using Python, based on a lecture I gave on the subject for MATH 3900 (Data Science) at the University of Utah. In these posts, I will discuss basics such as obtaining the data from Yahoo! Finance using…" rel="nofollow" data-origin="3081" data-position="2">An Introduction to Stock Market Data Analysis with Python (Part 1)</a></span><span class="jp-relatedposts-post-context">In "Economics and Finance"</span></p></div></div></div>			</div><!-- .entry-content -->

	<footer class="entry-meta"><span class="tags-links"><a href="https://ntguardian.wordpress.com/tag/alpha/" rel="tag">alpha</a> <a href="https://ntguardian.wordpress.com/tag/backtesting/" rel="tag">backtesting</a> <a href="https://ntguardian.wordpress.com/tag/backtrader/" rel="tag">backtrader</a> <a href="https://ntguardian.wordpress.com/tag/beta/" rel="tag">beta</a> <a href="https://ntguardian.wordpress.com/tag/blogging/" rel="tag">blogging</a> <a href="https://ntguardian.wordpress.com/tag/cross-validation/" rel="tag">cross-validation</a> <a href="https://ntguardian.wordpress.com/tag/finance/" rel="tag">finance</a> <a href="https://ntguardian.wordpress.com/tag/google/" rel="tag">google</a> <a href="https://ntguardian.wordpress.com/tag/google-finance/" rel="tag">google finance</a> <a href="https://ntguardian.wordpress.com/tag/graduate-school/" rel="tag">graduate school</a> <a href="https://ntguardian.wordpress.com/tag/machine-learning/" rel="tag">machine learning</a> <a href="https://ntguardian.wordpress.com/tag/moving-average/" rel="tag">moving average</a> <a href="https://ntguardian.wordpress.com/tag/moving-average-crossover-strategy/" rel="tag">moving average crossover strategy</a> <a href="https://ntguardian.wordpress.com/tag/numpy/" rel="tag">numpy</a> <a href="https://ntguardian.wordpress.com/tag/optimization/" rel="tag">optimization</a> <a href="https://ntguardian.wordpress.com/tag/packt-publishing/" rel="tag">packt publishing</a> <a href="https://ntguardian.wordpress.com/tag/pandas/" rel="tag">pandas</a> <a href="https://ntguardian.wordpress.com/tag/performanceanalytics/" rel="tag">performanceanalytics</a> <a href="https://ntguardian.wordpress.com/tag/portfolio-analytics/" rel="tag">portfolio analytics</a> <a href="https://ntguardian.wordpress.com/tag/programming/" rel="tag">programming</a> <a href="https://ntguardian.wordpress.com/tag/pyfolio/" rel="tag">pyfolio</a> <a href="https://ntguardian.wordpress.com/tag/quantmod/" rel="tag">quantmod</a> <a href="https://ntguardian.wordpress.com/tag/quantopian/" rel="tag">quantopian</a> <a href="https://ntguardian.wordpress.com/tag/r-python-integration/" rel="tag">r python integration</a> <a href="https://ntguardian.wordpress.com/tag/rpy2/" rel="tag">rpy2</a> <a href="https://ntguardian.wordpress.com/tag/sharpe-ratio/" rel="tag">sharpe ratio</a> <a href="https://ntguardian.wordpress.com/tag/sortino-ratio/" rel="tag">sortino ratio</a> <a href="https://ntguardian.wordpress.com/tag/technical-analysis/" rel="tag">technical analysis</a> <a href="https://ntguardian.wordpress.com/tag/unpacking-numpy-and-pandas/" rel="tag">unpacking numpy and pandas</a> <a href="https://ntguardian.wordpress.com/tag/walk-forward-analysis/" rel="tag">walk forward analysis</a> <a href="https://ntguardian.wordpress.com/tag/walk-forward-efficiency-ratio/" rel="tag">walk forward efficiency ratio</a> <a href="https://ntguardian.wordpress.com/tag/yahoo-finance/" rel="tag">yahoo finance</a></span></footer>
</article><!-- #post-## -->

				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<div class="nav-previous"><a href="https://ntguardian.wordpress.com/2017/06/19/walk-forward-analysis-demonstration-backtrader/" rel="prev"><span class="meta-nav">←</span> Walk-Forward Analysis Demonstration with&nbsp;backtrader</a></div><div class="nav-next"><a href="https://ntguardian.wordpress.com/2017/07/03/get-started-learning-python-data-science-unpacking-numpy-and-pandas/" rel="next">Get Started Learning Python for Data Science with “Unpacking NumPy and&nbsp;Pandas” <span class="meta-nav">→</span></a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			10 thoughts on “<span>Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and&nbsp;backtrader</span>”		</h2>

		
		<ol class="comment-list">
			
	<li id="comment-615" class="pingback even thread-even depth-1 highlander-comment">
		<div class="comment-body">
			Pingback: <a href="http://blog.explodingads.com/?p=257205" rel="external nofollow" class="url">1 – Stock Trading Analytics and Optimization</a> 		</div>

	</li><!-- #comment-## -->

	<li id="comment-616" class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment">
		<div class="comment-body">
			Pingback: <a href="http://adrian-tudor.com/blog/curtis-miller-stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/" rel="external nofollow" class="url">Curtis Miller: Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader | Adrian Tudor Web Designer and Programmer</a> 		</div>

	</li><!-- #comment-## -->

	<li id="comment-617" class="pingback even thread-even depth-1 highlander-comment">
		<div class="comment-body">
			Pingback: <a href="http://abunchofdata.com/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/" rel="external nofollow" class="url">Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader | A bunch of data</a> 		</div>

	</li><!-- #comment-## -->

	<li id="comment-618" class="pingback odd alt thread-odd thread-alt depth-1 highlander-comment">
		<div class="comment-body">
			Pingback: <a href="http://mqasim.me/?p=125533" rel="external nofollow" class="url">Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader – Mubashir Qasim</a> 		</div>

	</li><!-- #comment-## -->

	<li id="comment-620" class="comment byuser comment-author-ntguardian bypostauthor even thread-even depth-1 highlander-comment">
		<article id="div-comment-620" class="comment-body">
			<div class="comment-author vcard">
				<span class="avatar-wrapper"><img alt="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/3b1cca363ad60a8a837c9137d89c083b" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40" originals="40" src-orig="https://0.gravatar.com/avatar/3b1cca363ad60a8a837c9137d89c083b?s=40&amp;d=identicon&amp;r=G" scale="2" id="grav-3b1cca363ad60a8a837c9137d89c083b-0"></span>			</div><!-- .comment-author -->
			<div class="comment-wrapper">
				<div class="comment-content">
					<p>Some of the code here does not work. This is WordPress.com’s fault. I have tried multiple times to fix the code but the damn thing keeps garbling it. I’ve voiced my complaint on reddit (<a href="https://redd.it/6kbkez" rel="nofollow">https://redd.it/6kbkez</a>) and I’ve tried to contact WordPress.com’s support, but I’m starting to lose hope that these problems will get fixed by them. I’m getting fed up with WordPress.com and I’m not sure what to do about it.</p>
<p>If you really want the correct code, try checking older blog posts, or shoot me an e-mail and I’ll send you the .md file containing this blog post.</p>
<p id="comment-like-620" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?like_comment=620&amp;_wpnonce=d0353a834d" class="comment-like-link needs-login" rel="nofollow" data-blog="31302869"><span>Like</span></a><span id="comment-like-count-620" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->
				<footer class="comment-meta">

				
				<cite class="fn"><a href="https://ntguardian.wordpress.com/" rel="external nofollow" class="url">ntguardian</a></cite> 
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-620">
					<time datetime="2017-06-29T15:58:23+00:00">
						<span class="post-date">, June 29, 2017 at 3:58 pm</span>
					</time>
				</a>
								<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?replytocom=620#respond" onclick="return addComment.moveForm( &quot;div-comment-620&quot;, &quot;620&quot;, &quot;respond&quot;, &quot;3081&quot; )" aria-label="Reply to ntguardian">Reply</a></div>
				</footer><!-- .comment-meta -->
			</div>
		</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-621" class="comment byuser comment-author-tbrander odd alt thread-odd thread-alt depth-1 parent highlander-comment">
		<article id="div-comment-621" class="comment-body">
			<div class="comment-author vcard">
				<span class="avatar-wrapper"><img alt="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/938a1132d5f1b2c5a54345b0e672689c" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40" originals="40" src-orig="https://0.gravatar.com/avatar/938a1132d5f1b2c5a54345b0e672689c?s=40&amp;d=identicon&amp;r=G" scale="2" id="grav-938a1132d5f1b2c5a54345b0e672689c-0"></span>			</div><!-- .comment-author -->
			<div class="comment-wrapper">
				<div class="comment-content">
					<p>Getting your code properly public, post it to github… show it here and put the real working stuff in a free repo.. See <a href="http://oswco.com/" rel="nofollow">http://oswco.com</a> for one example…</p>
<p id="comment-like-621" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?like_comment=621&amp;_wpnonce=6ab50fd525" class="comment-like-link needs-login" rel="nofollow" data-blog="31302869"><span>Like</span></a><span id="comment-like-count-621" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->
				<footer class="comment-meta">

				
				<cite class="fn"><a href="http://tbrander.wordpress.com/" rel="external nofollow" class="url">Tom Brander</a></cite> 
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-621">
					<time datetime="2017-06-29T20:02:53+00:00">
						<span class="post-date">, June 29, 2017 at 8:02 pm</span>
					</time>
				</a>
								<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?replytocom=621#respond" onclick="return addComment.moveForm( &quot;div-comment-621&quot;, &quot;621&quot;, &quot;respond&quot;, &quot;3081&quot; )" aria-label="Reply to Tom Brander">Reply</a></div>
				</footer><!-- .comment-meta -->
			</div>
		</article><!-- .comment-body -->

	<ul class="children">

	<li id="comment-622" class="comment byuser comment-author-ntguardian bypostauthor even depth-2 highlander-comment">
		<article id="div-comment-622" class="comment-body">
			<div class="comment-author vcard">
				<span class="avatar-wrapper"><img alt="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/3b1cca363ad60a8a837c9137d89c083b" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40" originals="40" src-orig="https://0.gravatar.com/avatar/3b1cca363ad60a8a837c9137d89c083b?s=40&amp;d=identicon&amp;r=G" scale="2" id="grav-3b1cca363ad60a8a837c9137d89c083b-1"></span>			</div><!-- .comment-author -->
			<div class="comment-wrapper">
				<div class="comment-content">
					<p>I got it fixed. Source code appears fine now. I was referred to this link: <a href="https://en.support.wordpress.com/code/posting-source-code/" rel="nofollow">https://en.support.wordpress.com/code/posting-source-code/</a> It actually has features I like.</p>
<p id="comment-like-622" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?like_comment=622&amp;_wpnonce=d7f9e00d1f" class="comment-like-link needs-login" rel="nofollow" data-blog="31302869"><span>Like</span></a><span id="comment-like-count-622" class="comment-like-feedback">Like</span></p>
				</div><!-- .comment-content -->
				<footer class="comment-meta">

				
				<cite class="fn"><a href="https://ntguardian.wordpress.com/" rel="external nofollow" class="url">ntguardian</a></cite> 
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-622">
					<time datetime="2017-06-30T09:52:04+00:00">
						<span class="post-date">, June 30, 2017 at 9:52 am</span>
					</time>
				</a>
								<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?replytocom=622#respond" onclick="return addComment.moveForm( &quot;div-comment-622&quot;, &quot;622&quot;, &quot;respond&quot;, &quot;3081&quot; )" aria-label="Reply to ntguardian">Reply</a></div>
				</footer><!-- .comment-meta -->
			</div>
		</article><!-- .comment-body -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li id="comment-630" class="pingback odd alt thread-even depth-1 highlander-comment">
		<div class="comment-body">
			Pingback: <a href="https://ntguardian.wordpress.com/2017/07/03/get-started-learning-python-data-science-unpacking-numpy-and-pandas/" rel="external nofollow" class="url">Get Started Learning Python for Data Science with “Unpacking NumPy and Pandas” | Curtis Miller's Personal Website</a> 		</div>

	</li><!-- #comment-## -->

	<li id="comment-666" class="comment even thread-odd thread-alt depth-1 highlander-comment">
		<article id="div-comment-666" class="comment-body">
			<div class="comment-author vcard">
				<span class="avatar-wrapper"><img alt="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/f9b0137cb32be76e5a171bff7ce98da7" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40" originals="40" src-orig="https://0.gravatar.com/avatar/f9b0137cb32be76e5a171bff7ce98da7?s=40&amp;d=identicon&amp;r=G" scale="2" id="grav-f9b0137cb32be76e5a171bff7ce98da7-0"></span>			</div><!-- .comment-author -->
			<div class="comment-wrapper">
				<div class="comment-content">
					<p>Great blog and I’ve read all your posts, not just the three you listed as most popular. Don’t despair at bad advice. Do what makes you happy and set your own goals for your interests. As far as academia goes, you’ll be a bit stuck with whatever regime you’re assumed to have adopted via your faculty. Publishing books not directly related to your research is your own business, not theirs, and it’s personal so do it if you enjoy it. You write well and clearly and other people should derive benefit and you’ll feel good about that, too.</p>
<p id="comment-like-666" data-liked="comment-not-liked" class="comment-likes comment-not-liked"><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?like_comment=666&amp;_wpnonce=7c7bf55bda" class="comment-like-link needs-login" rel="nofollow" data-blog="31302869"><span>Like</span></a><span id="comment-like-count-666" class="comment-like-feedback">Liked by <a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="view-likers" data-like-count="1">1 person</a></span></p>
				</div><!-- .comment-content -->
				<footer class="comment-meta">

				
				<cite class="fn"><a href="http://gravatar.com/zefertzegrg" rel="external nofollow" class="url">zefertzegrg</a></cite> 
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-666">
					<time datetime="2017-07-14T14:55:20+00:00">
						<span class="post-date">, July 14, 2017 at 2:55 pm</span>
					</time>
				</a>
								<div class="reply"><a rel="nofollow" class="comment-reply-link" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/?replytocom=666#respond" onclick="return addComment.moveForm( &quot;div-comment-666&quot;, &quot;666&quot;, &quot;respond&quot;, &quot;3081&quot; )" aria-label="Reply to zefertzegrg">Reply</a></div>
				</footer><!-- .comment-meta -->
			</div>
		</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-880" class="pingback odd alt thread-even depth-1 highlander-comment">
		<div class="comment-body">
			Pingback: <a href="https://ntguardian.wordpress.com/2017/10/06/mad-libs-and-python/" rel="external nofollow" class="url">Mad Libs and Python | Curtis Miller's Personal Website</a> 		</div>

	</li><!-- #comment-## -->
		</ol><!-- .center-block .comment-list -->

		
	
	
		<div id="respond" class="comment-respond js">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://ntguardian.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="">
				<input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="471d2c5571"><input type="hidden" name="_wp_http_referer" value="/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea tabindex="-1" style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px; padding: 0px; box-sizing: content-box; word-wrap: break-word; overflow: hidden; transition: none; height: 0px !important; min-height: 0px !important; font-family: Arial, Helvetica, Tahoma, Verdana, sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: none solid rgba(0, 0, 0, 0.7); word-spacing: 0px; text-indent: 0px; line-height: 21px; width: 658px;" class="autosizejs "></textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 41px; overflow: hidden; word-wrap: break-word; resize: none;"></textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
			<li>
			<iframe id="googleplus-sign-in" name="googleplus-sign-in" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(12).html" width="24" height="24" scrolling="no" allowtransparency="true" seamless="seamless" frameborder="0"></iframe>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ad516503a11cd5ca435acc9bb6523536" alt="Gravatar" width="25" class="no-grav" originals="25" src-orig="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" scale="2">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email" value=""></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text" value=""></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url" value=""></div>
				</div>
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ad516503a11cd5ca435acc9bb6523536(1)" alt="WordPress.com Logo" width="25" class="no-grav" originals="25" scale="2">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;wordpress&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ad516503a11cd5ca435acc9bb6523536(1)" alt="Twitter picture" width="25" class="no-grav" originals="25" scale="2">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="">
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;twitter&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ad516503a11cd5ca435acc9bb6523536(1)" alt="Facebook photo" width="25" class="no-grav" originals="25" scale="2">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;facebook&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/ad516503a11cd5ca435acc9bb6523536(1)" alt="Google+ photo" width="25" class="no-grav" originals="25" scale="2">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="">
				<p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( &#39;googleplus&#39; );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p></div>




<p class="form-submit" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="3081" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8820509e45"></p>
<input type="hidden" name="genseq" value="1519577563">
<p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1519577562820"></form>
			</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments .comments-area -->

		
		</main><!-- #main .site-main -->
	</div><!-- #primary .content-area -->



		<footer id="colophon" class="site-footer" role="contentinfo">

			<div class="site-info">
								<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a>
				
							</div><!-- .site-info -->

		</footer><!-- #colophon .site-footer -->

	</div><!-- #content -->
</div><!-- #page -->

<!--  -->
<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/gprofiles.js.ladda ned"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/wpgroho.js.ladda ned"></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-3b1cca363ad60a8a837c9137d89c083b">
	</div>
	<div class="grofile-hash-map-938a1132d5f1b2c5a54345b0e672689c">
	</div>
	<div class="grofile-hash-map-f9b0137cb32be76e5a171bff7ce98da7">
	</div>
	</div>
<script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/ntguardian.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/ntguardian.wordpress.com\/wp-login.php?action=logout&_wpnonce=a5728e1ea3","homeURL":"https:\/\/ntguardian.wordpress.com\/","postID":"3081","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"0","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
/* ]]> */
</script>
<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(4)"></script>

	<div id="carousel-reblog-box">
		<form action="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" name="carousel-reblog">
			<textarea id="carousel-reblog-content" name="carousel-reblog-content" placeholder="Add your thoughts here... (optional)"></textarea>
			<label for="carousel-reblog-to-blog-id" id="carousel-reblog-lblogid">Post to</label>
			<select name="carousel-reblog-to-blog-id" id="carousel-reblog-to-blog-id">
						</select>

			<div class="submit">
				<span class="canceltext"><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#" class="cancel">Cancel</a></span>
				<input type="submit" name="carousel-reblog-submit" class="button" id="carousel-reblog-submit" value="Reblog Post">
				<input type="hidden" id="carousel-reblog-blog-id" value="31302869">
				<input type="hidden" id="carousel-reblog-blog-url" value="https://ntguardian.wordpress.com">
				<input type="hidden" id="carousel-reblog-blog-title" value="Curtis Miller&#39;s Personal Website">
				<input type="hidden" id="carousel-reblog-post-url" value="">
				<input type="hidden" id="carousel-reblog-post-title" value="">
			</div>

			<input type="hidden" id="_wpnonce" name="_wpnonce" value="c0d919a78a"><input type="hidden" name="_wp_http_referer" value="/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/">		</form>

		<div class="arrow"></div>
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/ntguardian.wordpress.com\/2017\/06\/28\/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader\/":3081};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
			
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-linkedin' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-tumblr' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtumblr', 'menubar=1,resizable=1,width=450,height=450' );
				return false;
			});
		});
		</script>
							<script type="text/javascript">
				jQuery(document).on('ready', function(){
					jQuery('body').on('click', 'a.share-pinterest', function(e){
						e.preventDefault();
						// Load Pinterest Bookmarklet code
						var s = document.createElement("script");
						s.type = "text/javascript";
						s.src = window.location.protocol + "//assets.pinterest.com/js/pinmarklet.js?r=" + ( Math.random() * 99999999 );
						var x = document.getElementsByTagName("script")[0];
						x.parentNode.insertBefore(s, x);
						// Trigger Stats
						var s = document.createElement("script");
						s.type = "text/javascript";
						s.src = this + ( this.toString().indexOf( '?' ) ? '&' : '?' ) + 'js_only=1';
						var x = document.getElementsByTagName("script")[0];
						x.parentNode.insertBefore(s, x);
					});
				});
			</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-pocket' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcompocket', 'menubar=1,resizable=1,width=450,height=450' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-telegram' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtelegram', 'menubar=1,resizable=1,width=450,height=450' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-skype' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomskype', 'menubar=1,resizable=1,width=305,height=665' );
				return false;
			});
		});
		</script>
		<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(5)"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

// Infinite scroll support
jQuery( function( $ ) {
	$( document.body ).on( 'post-load', function() {
		SyntaxHighlighter.highlight();
	} );
} );
</script>
<link rel="stylesheet" id="all-css-0-3" href="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/jetpack-carousel.css" type="text/css" media="all">
<!--[if lte IE 8]>
<link rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='https://s1.wp.com/wp-content/mu-plugins/carousel/jetpack-carousel-ie8fix.css?m=1412618825h&#038;ver=20121024' type='text/css' media='all' />
<![endif]-->
<script type="text/javascript">
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading..."};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var actionbardata = {"siteID":"31302869","siteName":"Curtis Miller's Personal Website","siteURL":"http:\/\/ntguardian.wordpress.com","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/adaption","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/ntguardian.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F","themeURL":"","xhrURL":"https:\/\/ntguardian.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"7d7c5c73df","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"9321ae6f8f\" \/>","referer":"https:\/\/ntguardian.wordpress.com\/2017\/06\/28\/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader\/","canFollow":"1","feedID":"18586460","statusMessage":"","customizeLink":"https:\/\/ntguardian.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F","postID":"3081","shortlink":"https:\/\/wp.me\/p27liZ-NH","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/ntguardian.wordpress.com\/3081","statsLink":"https:\/\/wordpress.com\/stats\/post\/3081\/ntguardian.wordpress.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Adaption","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 614 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/ntguardian.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F\">Log in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/ntguardian.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"ebba0e4bd2","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/ntguardian.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F","blog_id":"31302869","local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>","reblog":"Reblog","reblogged":"Reblogged","reblog_add_thoughts":"Add your thoughts here... (optional)","reblogging":"Reblogging...","post_reblog":"Post Reblog","stats_query_args":"blog=31302869&v=wpcom&tz=-7&user_id=0&subd=ntguardian","is_public":"1","reblog_enabled":""};
/* ]]> */
</script>
<script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/saved_resource(6)"></script><div id="actionbar" class="actnbr-pub-adaption actnbr-has-follow"><ul><li class="actnbr-btn actnbr-hidden"> 			    	<a class="actnbr-action actnbr-actn-follow" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/"><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a> 			    	<div class="actnbr-popover tip tip-top-left actnbr-notice"> 			    		<div class="tip-arrow"></div> 			    		<div class="tip-inner actnbr-follow-bubble"></div> 			    	</div> 			    </li><li class="actnbr-ellipsis actnbr-hidden"> 			  <svg class="gridicon gridicon__ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><circle cx="5" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle></g></svg> 			  <div class="actnbr-popover tip tip-top-left actnbr-more"> 			  	<div class="tip-arrow"></div> 			  	<div class="tip-inner"> 				  <ul> 				    <li class="actnbr-sitename actnbr-hidden"><a href="http://ntguardian.wordpress.com/"><img alt="" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/wpcom-gray-white.png" class="avatar avatar-50" height="50" width="50" scale="0"> Curtis Miller's Personal Website</a></li> 				   	<li class="actnbr-folded-customize actnbr-hidden"><a href="https://ntguardian.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F"><svg class="gridicon gridicon__customize" height="20px" width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z" data-reactid=".2.1.1:0.1b.0"></path></g></svg><span>Customize<span></span></span></a></li> 				    <li class="actnbr-folded-follow actnbr-hidden"><a class="actnbr-action actnbr-actn-follow" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/"><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a></li> 					<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li> 				    <li class="actnbr-login actnbr-hidden"><a href="https://ntguardian.wordpress.com/wp-login.php?redirect_to=https%3A%2F%2Fntguardian.wordpress.com%2F2017%2F06%2F28%2Fstock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader%2F">Log in</a></li> 				     				    <li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/p27liZ-NH">Copy shortlink</a></li> 				    <li class="flb-report actnbr-hidden"><a href="http://en.wordpress.com/abuse/">Report this content</a></li> 				     				     				    <li class="actnbr-subs actnbr-hidden"><a href="https://subscribe.wordpress.com/">Manage subscriptions</a></li> 				    <li class="actnbr-fold actnbr-hidden"><a href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/">Collapse this bar</a></li> 			      </ul> 			    </div> 		      </div> 		    </li> 	      </ul></div>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>		<iframe src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
		<div id="likes-other-gravatars"><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
<script src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/w.js.ladda ned" type="text/javascript" async="" defer=""></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'31302869','blog_tz':'-7','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'31302869','v':'wpcom','tz':'-7','user_id':'0','post':'3081','subd':'ntguardian'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRZS03JixXRU5XS21qZ0MwMGg2bjhNS19hQnhUZXdBLjNwbE4tUS98SE9sQTd5czZuZU5jX3x3bz9kMW1OLTdmbi5GRllZNCZsbUZ6W2s5WkdbOD1VX3hOS0FfPzlaTDU0VzhlLEZ8ZjZdOUoyNktxekRWQ0JNdX5QZDNyST1yTnprcGlHSzNKdTBCQk9+bTVbc0p1N2otUzJVOStJU3xRLU5lYzFsSC9wZSZbYUhSd1Iya0R1NG49YU5Fa3l0ZzlZdUU4eHlzaTA9SHRCY3xLdXhQM0ZCZV1CaEdfTFhqLks9Y0FNRVBCaFZwSG5RY29vcysmUHpHbmN8RlhkP3R4UEJYMU9VLnomOUlmai5nVFl5L1g0XQ=='}]);
_stq.push([ 'clickTrackerInit', '31302869', '3081' ]);
	</script>
<noscript>&lt;img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /&gt;</noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>


<!--
	generated in 0.326 seconds
	202922 bytes batcached for 300 seconds
-->
<div class="comment-likes-overlay" style="display: none;"></div><div id="sharing_email" style="display: none;">
		<form action="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/" method="post">
			<label for="target_email">Send to Email Address</label>
			<input type="email" name="target_email" id="target_email" value="">

			
				<label for="source_name">Your Name</label>
				<input type="text" name="source_name" id="source_name" value="">

				<label for="source_email">Your Email Address</label>
				<input type="email" name="source_email" id="source_email" value="">

						<input type="text" id="jetpack-source_f_name" name="source_f_name" class="input" value="" size="25" autocomplete="off">
			<script> document.getElementById('jetpack-source_f_name').value = ''; </script>
			<div class="recaptcha" id="sharing_recaptcha"></div><input type="hidden" name="recaptcha_public_key" id="recaptcha_public_key" value="6LcYW8MSAAAAADBAuEH9yaPcF7lWh11Iq62ZKtoo">
			<img style="float: right; display: none" class="loading" src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/loading.gif" alt="loading" width="16" height="16" scale="0">
			<input type="submit" value="Send Email" class="sharing_send">
			<a rel="nofollow" href="https://ntguardian.wordpress.com/2017/06/28/stock-trading-analytics-and-optimization-in-python-with-pyfolio-rs-performanceanalytics-and-backtrader/#cancel" class="sharing_cancel">Cancel</a>

			<div class="errors errors-1" style="display: none;">
				Post was not sent - check your email addresses!			</div>

			<div class="errors errors-2" style="display: none;">
				Email check failed, please try again			</div>

			<div class="errors errors-3" style="display: none;">
				Sorry, your blog cannot share posts by email.			</div>
		</form>
	</div><img src="./Stock Trading Analytics and Optimization in Python with PyFolio, R’s PerformanceAnalytics, and backtrader _ Curtis Miller&#39;s Personal Website_files/g.gif" alt=":)" id="wpstats" scale="0"></body></html>